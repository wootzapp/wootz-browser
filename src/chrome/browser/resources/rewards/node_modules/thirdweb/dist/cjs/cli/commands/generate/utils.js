"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.packageDirectory = packageDirectory;
const promises_1 = require("node:fs/promises");
const node_process_1 = require("node:process");
const node_url_1 = require("node:url");
const node_path_1 = require("node:path");
const node_url_2 = require("node:url");
const toPath = (urlOrPath) => urlOrPath instanceof node_url_2.URL ? (0, node_url_1.fileURLToPath)(urlOrPath) : urlOrPath;
async function findUp(name, { cwd = node_process_1.default.cwd(), type = "file", stopAt } = {}) {
    let directory = node_path_1.default.resolve(toPath(cwd) ?? "");
    const { root } = node_path_1.default.parse(directory);
    stopAt = node_path_1.default.resolve(directory, toPath(stopAt ?? root));
    while (directory && directory !== stopAt && directory !== root) {
        const filePath = node_path_1.default.isAbsolute(name) ? name : node_path_1.default.join(directory, name);
        try {
            const stats = await promises_1.default.stat(filePath);
            if ((type === "file" && stats.isFile()) ||
                (type === "directory" && stats.isDirectory())) {
                return filePath;
            }
        }
        catch { }
        directory = node_path_1.default.dirname(directory);
    }
    return undefined;
}
async function packageDirectory({ cwd } = {}) {
    const filePath = await findUp("package.json", { cwd });
    return filePath && node_path_1.default.dirname(filePath);
}
//# sourceMappingURL=utils.js.map