import { fetchPublishedContractMetadata } from "../../contract/deployment/publisher.js";
import { computeCreate2FactoryAddress } from "../../contract/deployment/utils/create-2-factory.js";
import { encodeAbiParameters } from "../abi/encodeAbiParameters.js";
import { getInitBytecodeWithSalt } from "./get-init-bytecode-with-salt.js";
/**
 * @internal
 */
export async function computeDeploymentInfoFromContractId(args) {
    const { client, chain, contractId, constructorParams, salt } = args;
    const contractMetadata = await fetchPublishedContractMetadata({
        client,
        contractId,
        publisher: args.publisher,
        version: args.version,
    });
    return computeDeploymentInfoFromMetadata({
        client,
        chain,
        contractMetadata,
        constructorParams,
        salt,
    });
}
/**
 * @internal
 */
export async function computeDeploymentInfoFromMetadata(args) {
    const { client, chain, contractMetadata, constructorParams, salt } = args;
    const { compilerMetadata } = contractMetadata;
    const create2FactoryAddress = await computeCreate2FactoryAddress({
        client,
        chain,
    });
    const bytecode = compilerMetadata.bytecode;
    const constructorAbi = compilerMetadata.abi.find((abi) => abi.type === "constructor") || [];
    const encodedArgs = encodeAbiParameters(constructorAbi.inputs ?? [], constructorParams);
    const initBytecodeWithsalt = getInitBytecodeWithSalt({
        bytecode,
        encodedArgs,
        salt,
    });
    return {
        bytecode,
        initBytecodeWithsalt,
        encodedArgs,
        create2FactoryAddress,
    };
}
//# sourceMappingURL=compute-published-contract-deploy-info.js.map