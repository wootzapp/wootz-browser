"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getKeylessTransaction = getKeylessTransaction;
const viem_1 = require("viem");
const keccak256_js_1 = require("../hashing/keccak256.js");
/**
 * Retrieves the keyless transaction information.
 *
 * @param options - The options for retrieving the keyless transaction.
 * @returns An object containing the signer address and the signed serialized transaction string.
 * @internal
 */
async function getKeylessTransaction(options) {
    // 1. Create serialized txn string
    const hash = (0, keccak256_js_1.keccak256)((0, viem_1.serializeTransaction)(options.transaction));
    // 2. Determine signer address from custom signature + txn
    const address = await (0, viem_1.recoverAddress)({
        hash,
        signature: (0, viem_1.signatureToHex)(options.signature),
    });
    // 3. Create the signed serialized txn string.
    // To be sent directly to the chain using a provider.
    const transaction = (0, viem_1.serializeTransaction)(options.transaction, options.signature);
    return {
        signerAddress: address,
        transaction,
    };
}
//# sourceMappingURL=keyless-transaction.js.map