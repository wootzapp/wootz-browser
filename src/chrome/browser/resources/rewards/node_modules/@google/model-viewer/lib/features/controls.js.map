{"version":3,"file":"controls.js","sourceRoot":"","sources":["../../src/features/controls.ts"],"names":[],"mappings":"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","sourcesContent":["/* @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {property} from 'lit/decorators.js';\nimport {Event, PerspectiveCamera, Spherical, Vector3} from 'three';\n\nimport {style} from '../decorators.js';\nimport ModelViewerElementBase, {$ariaLabel, $container, $getModelIsVisible, $loadedTime, $needsRender, $onModelLoad, $onResize, $renderer, $scene, $tick, $updateStatus, $userInputElement, toVector3D, Vector3D} from '../model-viewer-base.js';\nimport {degreesToRadians, normalizeUnit} from '../styles/conversions.js';\nimport {EvaluatedStyle, Intrinsics, SphericalIntrinsics, StyleEvaluator, Vector3Intrinsics} from '../styles/evaluators.js';\nimport {IdentNode, NumberNode, numberNode, parseExpressions} from '../styles/parsers.js';\nimport {DECAY_MILLISECONDS} from '../three-components/Damper.js';\nimport {ChangeEvent, ChangeSource, PointerChangeEvent, SmoothControls} from '../three-components/SmoothControls.js';\nimport {Constructor} from '../utilities.js';\nimport {Path, timeline, TimingFunction} from '../utilities/animation.js';\n\n\n\n// NOTE(cdata): The following \"animation\" timing functions are deliberately\n// being used in favor of CSS animations. In Safari 12.1 and 13, CSS animations\n// would cause the interaction prompt to glitch unexpectedly\n// @see https://github.com/google/model-viewer/issues/839\nconst PROMPT_ANIMATION_TIME = 5000;\n\n// For timing purposes, a \"frame\" is a timing agnostic relative unit of time\n// and a \"value\" is a target value for the Frame.\nconst wiggle = timeline({\n  initialValue: 0,\n  keyframes: [\n    {frames: 5, value: -1},\n    {frames: 1, value: -1},\n    {frames: 8, value: 1},\n    {frames: 1, value: 1},\n    {frames: 5, value: 0},\n    {frames: 18, value: 0}\n  ]\n});\n\nconst fade = timeline({\n  initialValue: 0,\n  keyframes: [\n    {frames: 1, value: 1},\n    {frames: 5, value: 1},\n    {frames: 1, value: 0},\n    {frames: 6, value: 0}\n  ]\n});\n\nexport const DEFAULT_FOV_DEG = 30;\nexport const DEFAULT_MIN_FOV_DEG = 12;\n\nexport const DEFAULT_CAMERA_ORBIT = '0deg 75deg 105%';\nconst DEFAULT_CAMERA_TARGET = 'auto auto auto';\nconst DEFAULT_FIELD_OF_VIEW = 'auto';\n\nconst MINIMUM_RADIUS_RATIO = 2.2;\n\nconst AZIMUTHAL_QUADRANT_LABELS = ['front', 'right', 'back', 'left'];\nconst POLAR_TRIENT_LABELS = ['upper-', '', 'lower-'];\n\nexport const DEFAULT_INTERACTION_PROMPT_THRESHOLD = 3000;\nexport const INTERACTION_PROMPT = '. Use mouse, touch or arrow keys to move.';\n\nexport interface CameraChangeDetails {\n  source: ChangeSource;\n}\n\nexport interface SphericalPosition {\n  theta: number;  // equator angle around the y (up) axis.\n  phi: number;    // polar angle from the y (up) axis.\n  radius: number;\n  toString(): string;\n}\n\nexport interface Finger {\n  x: Path;\n  y: Path;\n}\n\nexport type InteractionPromptStrategy = 'auto'|'none';\nexport type InteractionPromptStyle = 'basic'|'wiggle';\nexport type TouchAction = 'pan-y'|'pan-x'|'none';\n\nexport const InteractionPromptStrategy:\n    {[index: string]: InteractionPromptStrategy} = {\n      AUTO: 'auto',\n      NONE: 'none'\n    };\n\nexport const InteractionPromptStyle:\n    {[index: string]: InteractionPromptStyle} = {\n      BASIC: 'basic',\n      WIGGLE: 'wiggle'\n    };\n\nexport const TouchAction: {[index: string]: TouchAction} = {\n  PAN_Y: 'pan-y',\n  PAN_X: 'pan-x',\n  NONE: 'none'\n};\n\nexport const fieldOfViewIntrinsics = () => {\n  return {\n    basis:\n        [degreesToRadians(numberNode(DEFAULT_FOV_DEG, 'deg')) as\n         NumberNode<'rad'>],\n    keywords: {auto: [null]}\n  };\n};\n\nconst minFieldOfViewIntrinsics = () => {\n  return {\n    basis:\n        [degreesToRadians(numberNode(DEFAULT_MIN_FOV_DEG, 'deg')) as\n         NumberNode<'rad'>],\n    keywords: {auto: [null]}\n  };\n};\n\nexport const cameraOrbitIntrinsics = (() => {\n  const defaultTerms =\n      parseExpressions(DEFAULT_CAMERA_ORBIT)[0]\n          .terms as [NumberNode<'rad'>, NumberNode<'rad'>, IdentNode];\n\n  const theta = normalizeUnit(defaultTerms[0]) as NumberNode<'rad'>;\n  const phi = normalizeUnit(defaultTerms[1]) as NumberNode<'rad'>;\n\n  return (element: ModelViewerElementBase) => {\n    const radius = element[$scene].idealCameraDistance();\n\n    return {\n      basis: [theta, phi, numberNode(radius, 'm')],\n      keywords: {auto: [null, null, numberNode(105, '%')]}\n    };\n  };\n})();\n\nconst minCameraOrbitIntrinsics = (element: ModelViewerElementBase&\n                                  ControlsInterface) => {\n  const radius = MINIMUM_RADIUS_RATIO * element[$scene].boundingSphere.radius;\n\n  return {\n    basis: [\n      numberNode(-Infinity, 'rad'),\n      numberNode(Math.PI / 8, 'rad'),\n      numberNode(radius, 'm')\n    ],\n    keywords: {auto: [null, null, null]}\n  };\n};\n\nconst maxCameraOrbitIntrinsics = (element: ModelViewerElementBase) => {\n  const orbitIntrinsics = cameraOrbitIntrinsics(element);\n  const evaluator = new StyleEvaluator([], orbitIntrinsics);\n  const defaultRadius = evaluator.evaluate()[2];\n\n  return {\n    basis: [\n      numberNode(Infinity, 'rad'),\n      numberNode(Math.PI - Math.PI / 8, 'rad'),\n      numberNode(defaultRadius, 'm')\n    ],\n    keywords: {auto: [null, null, null]}\n  };\n};\n\nexport const cameraTargetIntrinsics = (element: ModelViewerElementBase) => {\n  const center = element[$scene].boundingBox.getCenter(new Vector3());\n\n  return {\n    basis: [\n      numberNode(center.x, 'm'),\n      numberNode(center.y, 'm'),\n      numberNode(center.z, 'm')\n    ],\n    keywords: {auto: [null, null, null]}\n  };\n};\n\nconst HALF_PI = Math.PI / 2.0;\nconst THIRD_PI = Math.PI / 3.0;\nconst QUARTER_PI = HALF_PI / 2.0;\nconst TAU = 2.0 * Math.PI;\n\nexport const $controls = Symbol('controls');\nexport const $panElement = Symbol('panElement');\nexport const $promptElement = Symbol('promptElement');\nexport const $promptAnimatedContainer = Symbol('promptAnimatedContainer');\nexport const $fingerAnimatedContainers = Symbol('fingerAnimatedContainers');\n\nconst $deferInteractionPrompt = Symbol('deferInteractionPrompt');\nconst $updateAria = Symbol('updateAria');\nconst $updateCameraForRadius = Symbol('updateCameraForRadius');\n\nconst $onChange = Symbol('onChange');\nconst $onPointerChange = Symbol('onPointerChange');\n\nconst $waitingToPromptUser = Symbol('waitingToPromptUser');\nconst $userHasInteracted = Symbol('userHasInteracted');\nconst $promptElementVisibleTime = Symbol('promptElementVisibleTime');\nconst $lastPromptOffset = Symbol('lastPromptOffset');\n\nconst $lastSpherical = Symbol('lastSpherical');\nconst $jumpCamera = Symbol('jumpCamera');\nconst $initialized = Symbol('initialized');\nconst $maintainThetaPhi = Symbol('maintainThetaPhi');\n\nconst $syncCameraOrbit = Symbol('syncCameraOrbit');\nconst $syncFieldOfView = Symbol('syncFieldOfView');\nconst $syncCameraTarget = Symbol('syncCameraTarget');\n\nconst $syncMinCameraOrbit = Symbol('syncMinCameraOrbit');\nconst $syncMaxCameraOrbit = Symbol('syncMaxCameraOrbit');\nconst $syncMinFieldOfView = Symbol('syncMinFieldOfView');\nconst $syncMaxFieldOfView = Symbol('syncMaxFieldOfView');\n\nexport declare interface ControlsInterface {\n  cameraControls: boolean;\n  cameraOrbit: string;\n  cameraTarget: string;\n  fieldOfView: string;\n  minCameraOrbit: string;\n  maxCameraOrbit: string;\n  minFieldOfView: string;\n  maxFieldOfView: string;\n  interactionPrompt: InteractionPromptStrategy;\n  interactionPromptStyle: InteractionPromptStyle;\n  interactionPromptThreshold: number;\n  orbitSensitivity: number;\n  touchAction: TouchAction;\n  interpolationDecay: number;\n  disableZoom: boolean;\n  disablePan: boolean;\n  disableTap: boolean;\n  getCameraOrbit(): SphericalPosition;\n  getCameraTarget(): Vector3D;\n  getFieldOfView(): number;\n  getMinimumFieldOfView(): number;\n  getMaximumFieldOfView(): number;\n  getIdealAspect(): number;\n  jumpCameraToGoal(): void;\n  updateFraming(): Promise<void>;\n  resetInteractionPrompt(): void;\n  zoom(keyPresses: number): void;\n  interact(duration: number, finger0: Finger, finger1?: Finger): void;\n  inputSensitivity: number;\n}\n\nexport const ControlsMixin = <T extends Constructor<ModelViewerElementBase>>(\n    ModelViewerElement: T): Constructor<ControlsInterface>&T => {\n  class ControlsModelViewerElement extends ModelViewerElement {\n    @property({type: Boolean, attribute: 'camera-controls'})\n    cameraControls: boolean = false;\n\n    @style({\n      intrinsics: cameraOrbitIntrinsics,\n      observeEffects: true,\n      updateHandler: $syncCameraOrbit\n    })\n    @property({type: String, attribute: 'camera-orbit', hasChanged: () => true})\n    cameraOrbit: string = DEFAULT_CAMERA_ORBIT;\n\n    @style({\n      intrinsics: cameraTargetIntrinsics,\n      observeEffects: true,\n      updateHandler: $syncCameraTarget\n    })\n    @property(\n        {type: String, attribute: 'camera-target', hasChanged: () => true})\n    cameraTarget: string = DEFAULT_CAMERA_TARGET;\n\n    @style({\n      intrinsics: fieldOfViewIntrinsics,\n      observeEffects: true,\n      updateHandler: $syncFieldOfView\n    })\n    @property(\n        {type: String, attribute: 'field-of-view', hasChanged: () => true})\n    fieldOfView: string = DEFAULT_FIELD_OF_VIEW;\n\n    @style({\n      intrinsics: minCameraOrbitIntrinsics,\n      updateHandler: $syncMinCameraOrbit\n    })\n    @property(\n        {type: String, attribute: 'min-camera-orbit', hasChanged: () => true})\n    minCameraOrbit: string = 'auto';\n\n    @style({\n      intrinsics: maxCameraOrbitIntrinsics,\n      updateHandler: $syncMaxCameraOrbit\n    })\n    @property(\n        {type: String, attribute: 'max-camera-orbit', hasChanged: () => true})\n    maxCameraOrbit: string = 'auto';\n\n    @style({\n      intrinsics: minFieldOfViewIntrinsics,\n      updateHandler: $syncMinFieldOfView\n    })\n    @property(\n        {type: String, attribute: 'min-field-of-view', hasChanged: () => true})\n    minFieldOfView: string = 'auto';\n\n    @style(\n        {intrinsics: fieldOfViewIntrinsics, updateHandler: $syncMaxFieldOfView})\n    @property(\n        {type: String, attribute: 'max-field-of-view', hasChanged: () => true})\n    maxFieldOfView: string = 'auto';\n\n    @property({type: Number, attribute: 'interaction-prompt-threshold'})\n    interactionPromptThreshold: number = DEFAULT_INTERACTION_PROMPT_THRESHOLD;\n\n    @property({type: String, attribute: 'interaction-prompt'})\n    interactionPrompt: InteractionPromptStrategy =\n        InteractionPromptStrategy.AUTO;\n\n    @property({type: String, attribute: 'interaction-prompt-style'})\n    interactionPromptStyle: InteractionPromptStyle =\n        InteractionPromptStyle.WIGGLE;\n\n    @property({type: Number, attribute: 'orbit-sensitivity'})\n    orbitSensitivity: number = 1;\n\n    @property({type: String, attribute: 'touch-action'})\n    touchAction: TouchAction = TouchAction.NONE;\n\n    @property({type: Boolean, attribute: 'disable-zoom'})\n    disableZoom: boolean = false;\n\n    @property({type: Boolean, attribute: 'disable-pan'})\n    disablePan: boolean = false;\n\n    @property({type: Boolean, attribute: 'disable-tap'})\n    disableTap: boolean = false;\n\n    @property({type: Number, attribute: 'interpolation-decay'})\n    interpolationDecay: number = DECAY_MILLISECONDS;\n\n    protected[$promptElement] =\n        this.shadowRoot!.querySelector('.interaction-prompt') as HTMLElement;\n    protected[$promptAnimatedContainer] =\n        this.shadowRoot!.querySelector('#prompt') as HTMLElement;\n    protected[$fingerAnimatedContainers]: HTMLElement[] = [\n      this.shadowRoot!.querySelector('#finger0')!,\n      this.shadowRoot!.querySelector('#finger1')!\n    ];\n    protected[$panElement] =\n        this.shadowRoot!.querySelector('.pan-target') as HTMLElement;\n\n    protected[$lastPromptOffset] = 0;\n    protected[$promptElementVisibleTime] = Infinity;\n    protected[$userHasInteracted] = false;\n    protected[$waitingToPromptUser] = false;\n\n    protected[$controls] = new SmoothControls(\n        this[$scene].camera as PerspectiveCamera, this[$userInputElement],\n        this[$scene]);\n\n    protected[$lastSpherical] = new Spherical();\n    protected[$jumpCamera] = false;\n    protected[$initialized] = false;\n    protected[$maintainThetaPhi] = false;\n\n    get inputSensitivity(): number {\n      return this[$controls].inputSensitivity;\n    }\n\n    set inputSensitivity(value: number) {\n      this[$controls].inputSensitivity = value;\n    }\n\n    getCameraOrbit(): SphericalPosition {\n      const {theta, phi, radius} = this[$lastSpherical];\n      return {\n        theta,\n        phi,\n        radius,\n        toString() {\n          return `${this.theta}rad ${this.phi}rad ${this.radius}m`;\n        }\n      };\n    }\n\n    getCameraTarget(): Vector3D {\n      return toVector3D(\n          this[$renderer].isPresenting ? this[$renderer].arRenderer.target :\n                                         this[$scene].getTarget());\n    }\n\n    getFieldOfView(): number {\n      return this[$controls].getFieldOfView();\n    }\n\n    // Provided so user code does not have to parse these from attributes.\n    getMinimumFieldOfView(): number {\n      return this[$controls].options.minimumFieldOfView!;\n    }\n\n    getMaximumFieldOfView(): number {\n      return this[$controls].options.maximumFieldOfView!;\n    }\n\n    getIdealAspect(): number {\n      return this[$scene].idealAspect;\n    }\n\n    jumpCameraToGoal() {\n      this[$jumpCamera] = true;\n      this.requestUpdate($jumpCamera, false);\n    }\n\n    resetInteractionPrompt() {\n      this[$lastPromptOffset] = 0;\n      this[$promptElementVisibleTime] = Infinity;\n      this[$userHasInteracted] = false;\n      this[$waitingToPromptUser] =\n          this.interactionPrompt === InteractionPromptStrategy.AUTO &&\n          this.cameraControls;\n    }\n\n    zoom(keyPresses: number) {\n      const event = new WheelEvent('wheel', {deltaY: -30 * keyPresses});\n      this[$userInputElement].dispatchEvent(event);\n    }\n\n    connectedCallback() {\n      super.connectedCallback();\n\n      this[$controls].addEventListener(\n          'change', this[$onChange] as (event: Event) => void);\n      this[$controls].addEventListener(\n          'pointer-change-start',\n          this[$onPointerChange] as (event: Event) => void);\n      this[$controls].addEventListener(\n          'pointer-change-end',\n          this[$onPointerChange] as (event: Event) => void);\n    }\n\n    disconnectedCallback() {\n      super.disconnectedCallback();\n\n      this[$controls].removeEventListener(\n          'change', this[$onChange] as (event: Event) => void);\n      this[$controls].removeEventListener(\n          'pointer-change-start',\n          this[$onPointerChange] as (event: Event) => void);\n      this[$controls].removeEventListener(\n          'pointer-change-end',\n          this[$onPointerChange] as (event: Event) => void);\n    }\n\n    updated(changedProperties: Map<string|number|symbol, unknown>) {\n      super.updated(changedProperties);\n\n      const controls = this[$controls];\n      const scene = this[$scene];\n\n      if (changedProperties.has('cameraControls')) {\n        if (this.cameraControls) {\n          controls.enableInteraction();\n          if (this.interactionPrompt === InteractionPromptStrategy.AUTO) {\n            this[$waitingToPromptUser] = true;\n          }\n        } else {\n          controls.disableInteraction();\n          this[$deferInteractionPrompt]();\n        }\n        this[$userInputElement].setAttribute('aria-label', this[$ariaLabel]);\n      }\n\n      if (changedProperties.has('disableZoom')) {\n        controls.disableZoom = this.disableZoom;\n      }\n\n      if (changedProperties.has('disablePan')) {\n        controls.enablePan = !this.disablePan;\n      }\n\n      if (changedProperties.has('disableTap')) {\n        controls.enableTap = !this.disableTap;\n      }\n\n      if (changedProperties.has('interactionPrompt') ||\n          changedProperties.has('cameraControls') ||\n          changedProperties.has('src')) {\n        if (this.interactionPrompt === InteractionPromptStrategy.AUTO &&\n            this.cameraControls && !this[$userHasInteracted]) {\n          this[$waitingToPromptUser] = true;\n        } else {\n          this[$deferInteractionPrompt]();\n        }\n      }\n\n      if (changedProperties.has('interactionPromptStyle')) {\n        this[$promptAnimatedContainer].style.opacity =\n            this.interactionPromptStyle == InteractionPromptStyle.BASIC ? '1' :\n                                                                          '0';\n      }\n\n      if (changedProperties.has('touchAction')) {\n        const touchAction = this.touchAction;\n        controls.applyOptions({touchAction});\n        controls.updateTouchActionStyle();\n      }\n\n      if (changedProperties.has('orbitSensitivity')) {\n        controls.orbitSensitivity = this.orbitSensitivity;\n      }\n\n      if (changedProperties.has('interpolationDecay')) {\n        controls.setDamperDecayTime(this.interpolationDecay);\n        scene.setTargetDamperDecayTime(this.interpolationDecay);\n      }\n\n      if (this[$jumpCamera] === true) {\n        Promise.resolve().then(() => {\n          controls.jumpToGoal();\n          scene.jumpToGoal();\n          this[$jumpCamera] = false;\n        });\n      }\n    }\n\n    async updateFraming() {\n      const scene = this[$scene];\n      const oldFramedFoV = scene.adjustedFoV(scene.framedFoVDeg);\n\n      await scene.updateFraming();\n\n      const newFramedFoV = scene.adjustedFoV(scene.framedFoVDeg);\n      const zoom = this[$controls].getFieldOfView() / oldFramedFoV;\n      this[$controls].setFieldOfView(newFramedFoV * zoom);\n      this[$maintainThetaPhi] = true;\n\n      this.requestUpdate('maxFieldOfView');\n      this.requestUpdate('fieldOfView');\n      this.requestUpdate('minCameraOrbit');\n      this.requestUpdate('maxCameraOrbit');\n      this.requestUpdate('cameraOrbit');\n      await this.updateComplete;\n    }\n\n    interact(duration: number, finger0: Finger, finger1?: Finger) {\n      const inputElement = this[$userInputElement];\n      const fingerElements = this[$fingerAnimatedContainers];\n\n      if (fingerElements[0].style.opacity === '1') {\n        console.warn(\n            'interact() failed because an existing interaction is running.')\n        return;\n      }\n\n      const xy = new Array<{x: TimingFunction, y: TimingFunction}>();\n      xy.push({x: timeline(finger0.x), y: timeline(finger0.y)});\n      const positions = [{x: xy[0].x(0), y: xy[0].y(0)}];\n\n      if (finger1 != null) {\n        xy.push({x: timeline(finger1.x), y: timeline(finger1.y)});\n        positions.push({x: xy[1].x(0), y: xy[1].y(0)});\n      }\n\n      let startTime = performance.now();\n      const {width, height} = this[$scene];\n\n      const dispatchTouches = (type: string) => {\n        for (const [i, position] of positions.entries()) {\n          const {style} = fingerElements[i];\n          style.transform = `translateX(${width * position.x}px) translateY(${\n              height * position.y}px)`;\n          if (type === 'pointerdown') {\n            style.opacity = '1';\n          } else if (type === 'pointerup') {\n            style.opacity = '0';\n          }\n\n          const init = {\n            pointerId: i - 5678,  // help ensure uniqueness\n            pointerType: 'touch',\n            target: inputElement,\n            clientX: width * position.x,\n            clientY: height * position.y,\n            altKey: true  // flag that this is not a user interaction\n          } as PointerEventInit;\n\n          inputElement.dispatchEvent(new PointerEvent(type, init));\n        }\n      };\n\n      const moveTouches = () => {\n        // Cancel interaction if something else moves the camera or input is\n        // removed from the DOM.\n        const {changeSource} = this[$controls];\n        if (changeSource !== ChangeSource.AUTOMATIC ||\n            !inputElement.isConnected) {\n          for (const fingerElement of this[$fingerAnimatedContainers]) {\n            fingerElement.style.opacity = '0';\n          }\n          dispatchTouches('pointercancel');\n          this.dispatchEvent(new CustomEvent<CameraChangeDetails>(\n              'interact-stopped', {detail: {source: changeSource}}));\n          document.removeEventListener('visibilitychange', onVisibilityChange);\n          return;\n        }\n\n        const time = Math.min(1, (performance.now() - startTime) / duration);\n        for (const [i, position] of positions.entries()) {\n          position.x = xy[i].x(time);\n          position.y = xy[i].y(time);\n        }\n        dispatchTouches('pointermove');\n\n        if (time < 1) {\n          requestAnimationFrame(moveTouches);\n        } else {\n          dispatchTouches('pointerup');\n          this.dispatchEvent(new CustomEvent<CameraChangeDetails>(\n              'interact-stopped', {detail: {source: changeSource}}));\n          document.removeEventListener('visibilitychange', onVisibilityChange);\n        }\n      };\n\n      const onVisibilityChange = () => {\n        let elapsed = 0;\n        if (document.visibilityState === 'hidden') {\n          elapsed = performance.now() - startTime;\n        } else {\n          startTime = performance.now() - elapsed;\n        }\n      };\n\n      document.addEventListener('visibilitychange', onVisibilityChange);\n\n      dispatchTouches('pointerdown');\n\n      requestAnimationFrame(moveTouches);\n    }\n\n    [$syncFieldOfView](style: EvaluatedStyle<Intrinsics<['rad']>>) {\n      const scene = this[$scene];\n      scene.framedFoVDeg = style[0] * 180 / Math.PI;\n      this[$controls].setFieldOfView(scene.adjustedFoV(scene.framedFoVDeg));\n    }\n\n    [$syncCameraOrbit](style: EvaluatedStyle<SphericalIntrinsics>) {\n      const controls = this[$controls];\n      if (this[$maintainThetaPhi]) {\n        const {theta, phi} = this.getCameraOrbit();\n        style[0] = theta;\n        style[1] = phi;\n        this[$maintainThetaPhi] = false;\n      }\n      controls.changeSource = ChangeSource.NONE;\n      controls.setOrbit(style[0], style[1], style[2]);\n    }\n\n    [$syncMinCameraOrbit](style: EvaluatedStyle<SphericalIntrinsics>) {\n      this[$controls].applyOptions({\n        minimumAzimuthalAngle: style[0],\n        minimumPolarAngle: style[1],\n        minimumRadius: style[2]\n      });\n      this.jumpCameraToGoal();\n    }\n\n    [$syncMaxCameraOrbit](style: EvaluatedStyle<SphericalIntrinsics>) {\n      this[$controls].applyOptions({\n        maximumAzimuthalAngle: style[0],\n        maximumPolarAngle: style[1],\n        maximumRadius: style[2]\n      });\n      this[$updateCameraForRadius](style[2]);\n      this.jumpCameraToGoal();\n    }\n\n    [$syncMinFieldOfView](style: EvaluatedStyle<Intrinsics<['rad']>>) {\n      this[$controls].applyOptions(\n          {minimumFieldOfView: style[0] * 180 / Math.PI});\n      this.jumpCameraToGoal();\n    }\n\n    [$syncMaxFieldOfView](style: EvaluatedStyle<Intrinsics<['rad']>>) {\n      const fov = this[$scene].adjustedFoV(style[0] * 180 / Math.PI);\n      this[$controls].applyOptions({maximumFieldOfView: fov});\n      this.jumpCameraToGoal();\n    }\n\n    [$syncCameraTarget](style: EvaluatedStyle<Vector3Intrinsics>) {\n      const [x, y, z] = style;\n      if (!this[$renderer].arRenderer.isPresenting) {\n        this[$scene].setTarget(x, y, z);\n      }\n      this[$controls].changeSource = ChangeSource.NONE;\n      this[$renderer].arRenderer.updateTarget();\n    }\n\n    [$tick](time: number, delta: number) {\n      super[$tick](time, delta);\n\n      if (this[$renderer].isPresenting || !this[$getModelIsVisible]()) {\n        return;\n      }\n\n      const controls = this[$controls];\n      const scene = this[$scene];\n\n      const now = performance.now();\n      if (this[$waitingToPromptUser]) {\n        if (this.loaded &&\n            now > this[$loadedTime] + this.interactionPromptThreshold) {\n          this[$waitingToPromptUser] = false;\n          this[$promptElementVisibleTime] = now;\n\n          this[$promptElement].classList.add('visible');\n        }\n      }\n\n      if (isFinite(this[$promptElementVisibleTime]) &&\n          this.interactionPromptStyle === InteractionPromptStyle.WIGGLE) {\n        const animationTime =\n            ((now - this[$promptElementVisibleTime]) / PROMPT_ANIMATION_TIME) %\n            1;\n        const offset = wiggle(animationTime);\n        const opacity = fade(animationTime);\n\n        this[$promptAnimatedContainer].style.opacity = `${opacity}`;\n\n        if (offset !== this[$lastPromptOffset]) {\n          const xOffset = offset * scene.width * 0.05;\n          const deltaTheta = (offset - this[$lastPromptOffset]) * Math.PI / 16;\n\n          this[$promptAnimatedContainer].style.transform =\n              `translateX(${xOffset}px)`;\n\n          controls.changeSource = ChangeSource.AUTOMATIC;\n          controls.adjustOrbit(deltaTheta, 0, 0);\n\n          this[$lastPromptOffset] = offset;\n        }\n      }\n\n      controls.update(time, delta);\n      if (scene.updateTarget(delta)) {\n        this[$onChange]({type: 'change', source: controls.changeSource});\n      }\n    }\n\n    [$deferInteractionPrompt]() {\n      // Effectively cancel the timer waiting for user interaction:\n      this[$waitingToPromptUser] = false;\n      this[$promptElement].classList.remove('visible');\n      this[$promptElementVisibleTime] = Infinity;\n    }\n\n    /**\n     * Updates the camera's near and far planes to enclose the scene when\n     * orbiting at the supplied radius.\n     */\n    [$updateCameraForRadius](radius: number) {\n      const maximumRadius =\n          Math.max(this[$scene].boundingSphere.radius, radius);\n\n      const near = 0;\n      const far = 2 * maximumRadius;\n      this[$controls].updateNearFar(near, far);\n    }\n\n    [$updateAria]() {\n      const {theta, phi} =\n          this[$controls]!.getCameraSpherical(this[$lastSpherical]);\n\n      const azimuthalQuadrant =\n          (4 + Math.floor(((theta % TAU) + QUARTER_PI) / HALF_PI)) % 4;\n\n      const polarTrient = Math.floor(phi / THIRD_PI);\n\n      const azimuthalQuadrantLabel =\n          AZIMUTHAL_QUADRANT_LABELS[azimuthalQuadrant];\n      const polarTrientLabel = POLAR_TRIENT_LABELS[polarTrient];\n\n      this[$updateStatus](\n          `View from stage ${polarTrientLabel}${azimuthalQuadrantLabel}`);\n    }\n\n    get[$ariaLabel]() {\n      return super[$ariaLabel] +\n          (this.cameraControls ? INTERACTION_PROMPT : '');\n    }\n\n    async[$onResize](event: any) {\n      const controls = this[$controls];\n      const scene = this[$scene];\n      const oldFramedFoV = scene.adjustedFoV(scene.framedFoVDeg);\n\n      // The super of $onResize may update the scene's adjustedFoV, so we\n      // compare the before and after to calculate the proper zoom.\n      super[$onResize](event);\n\n      const fovRatio = scene.adjustedFoV(scene.framedFoVDeg) / oldFramedFoV;\n      const fov =\n          controls.getFieldOfView() * (isFinite(fovRatio) ? fovRatio : 1);\n\n      controls.updateAspect(this[$scene].aspect);\n\n      this.requestUpdate('maxFieldOfView', this.maxFieldOfView);\n      await this.updateComplete;\n      this[$controls].setFieldOfView(fov);\n\n      this.jumpCameraToGoal();\n    }\n\n    [$onModelLoad]() {\n      super[$onModelLoad]();\n\n      if (this[$initialized]) {\n        this[$maintainThetaPhi] = true;\n      } else {\n        this[$initialized] = true;\n      }\n      this.requestUpdate('maxFieldOfView', this.maxFieldOfView);\n      this.requestUpdate('fieldOfView', this.fieldOfView);\n      this.requestUpdate('minCameraOrbit', this.minCameraOrbit);\n      this.requestUpdate('maxCameraOrbit', this.maxCameraOrbit);\n      this.requestUpdate('cameraOrbit', this.cameraOrbit);\n      this.requestUpdate('cameraTarget', this.cameraTarget);\n      this.jumpCameraToGoal();\n    }\n\n    [$onChange] = ({source}: ChangeEvent) => {\n      this[$updateAria]();\n      this[$needsRender]();\n\n      if (source === ChangeSource.USER_INTERACTION) {\n        this[$userHasInteracted] = true;\n        this[$deferInteractionPrompt]();\n      }\n\n      this.dispatchEvent(new CustomEvent<CameraChangeDetails>(\n          'camera-change', {detail: {source}}));\n    };\n\n    [$onPointerChange] = (event: PointerChangeEvent) => {\n      if (event.type === 'pointer-change-start') {\n        this[$container].classList.add('pointer-tumbling');\n      } else {\n        this[$container].classList.remove('pointer-tumbling');\n      }\n    };\n  }\n\n  return ControlsModelViewerElement;\n};\n"]}