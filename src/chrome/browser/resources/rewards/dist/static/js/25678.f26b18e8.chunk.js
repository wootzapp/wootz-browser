"use strict";(self.webpackChunkrewards=self.webpackChunkrewards||[]).push([[25678,63288,21299],{17749:(t,e,a)=>{async function n(t,e){return await t({method:"eth_sendRawTransaction",params:[e]})}a.d(e,{B:()=>n})},63288:(t,e,a)=>{a.d(e,{f:()=>A,sendEip712Transaction:()=>x,a:()=>P});var n=a(77378),r=a(17749),s=a(72364),i=a(3340);function o(t){if(["string","number"].includes(typeof t)&&!Number.isInteger(Number(t)))throw new Error(`Expected value to be an integer to convert to a bigint, got ${t} of type ${typeof t}`);return t instanceof Uint8Array?BigInt((0,i.EY)(t)):BigInt(t)}var c=a(21299),d=a(46325),u=a(79002),p=a(77300),m=a(17143),y=a(37131),l=a(11907);const f=32n*a(89492).Au;var h=a(21627);class g extends h.C{constructor(t){let{givenLength:e,maxBytecodeSize:a}=t;super(`Bytecode cannot be longer than ${a} bytes. Given length: ${e}`,{name:"BytecodeLengthExceedsMaxSizeError"})}}class v extends h.C{constructor(t){let{givenLengthInWords:e}=t;super(`Bytecode length in 32-byte words must be odd. Given length in words: ${e}`,{name:"BytecodeLengthInWordsMustBeOddError"})}}class G extends h.C{constructor(t){let{givenLength:e}=t;super(`The bytecode length in bytes must be divisible by 32. Given length: ${e}`,{name:"BytecodeLengthMustBeDivisibleBy32Error"})}}const w=50000n,b=t=>{const e=function(t){const{gas:e,nonce:a,to:n,from:r,value:s,maxFeePerGas:o,maxPriorityFeePerGas:c,paymaster:d,paymasterInput:u,gasPerPubdata:p,data:h,factoryDeps:b}=t;return{txType:113n,from:BigInt(r),to:n?BigInt(n):0n,gasLimit:e??0n,gasPerPubdataByteLimit:p??w,maxFeePerGas:o??0n,maxPriorityFeePerGas:c??0n,paymaster:d?BigInt(d):0n,nonce:a?BigInt(a):0n,value:s??0n,data:h||"0x0",factoryDeps:b?.map((t=>(0,i.nj)(function(t){const e=(0,y.ZJ)(t);if(e.length%32!==0)throw new G({givenLength:e.length});if(e.length>f)throw new g({givenLength:e.length,maxBytecodeSize:f});const a=(0,l.s)(e),n=(0,y.ZJ)(a),r=e.length/32;if(r%2===0)throw new v({givenLengthInWords:r});const s=(0,y.ZJ)(r),i=(0,m.eV)(s,{size:2}),o=new Uint8Array([1,0]);return n.set(o,0),n.set(i,2),n}(t))))??[],paymasterInput:u||"0x"}}(t);return{domain:{name:"zkSync",version:"2",chainId:t.chainId},types:{Transaction:[{name:"txType",type:"uint256"},{name:"from",type:"uint256"},{name:"to",type:"uint256"},{name:"gasLimit",type:"uint256"},{name:"gasPerPubdataByteLimit",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymaster",type:"uint256"},{name:"nonce",type:"uint256"},{name:"value",type:"uint256"},{name:"data",type:"bytes"},{name:"factoryDeps",type:"bytes32[]"},{name:"paymasterInput",type:"bytes"}]},primaryType:"Transaction",message:e}};async function x(t){const{account:e,transaction:a}=t,n=await A(t),i=await P({account:e,eip712Transaction:n,chainId:a.chain.id}),o=(0,s.getRpcClient)(a);return{transactionHash:await(0,r.B)(o,i),chain:a.chain,client:a.client}}async function P(t){const{account:e,eip712Transaction:a,chainId:r}=t,s=b(a),o=await e.signTypedData({...s});return function(t){const{chainId:e,gas:a,nonce:r,to:s,from:o,value:d,maxFeePerGas:u,maxPriorityFeePerGas:p,customSignature:m,factoryDeps:y,paymaster:l,paymasterInput:f,gasPerPubdata:h,data:g}=t,v=[r?(0,i.nj)(r):"0x",p?(0,i.nj)(p):"0x",u?(0,i.nj)(u):"0x",a?(0,i.nj)(a):"0x",s??"0x",d?(0,i.nj)(d):"0x",g??"0x0",(0,i.nj)(e),(0,i.nj)(""),(0,i.nj)(""),(0,i.nj)(e),o??"0x",h?(0,i.nj)(h):(0,i.nj)(w),y??[],m??"0x",l&&f?[l,f]:[]];return(0,c.concatHex)(["0x71",(0,n.EQ)(v)])}({...a,chainId:r,customSignature:o})}async function A(t){const{account:e,transaction:a}=t;let[n,r,c,m,y,l,f]=await Promise.all([(0,u.encode)(a),(0,d.r)(a.to),(0,d.r)(a.value),(0,d.r)(a.gas),(0,d.r)(a.maxFeePerGas),(0,d.r)(a.maxPriorityFeePerGas),(0,d.r)(a.eip712).then((t=>t?.gasPerPubdata))]);if(!m||!y||!l){const t=(0,s.getRpcClient)(a),d=await t({method:"zks_estimateFee",params:[{from:e.address,to:r,data:n,value:c?(0,i.cK)(c):void 0}]});m=o(d.gas_limit);y=2n*o(d.max_fee_per_gas),l=o(d.max_priority_fee_per_gas)||1n,f=2n*o(d.gas_per_pubdata_limit)}return{...await(0,p.$)({transaction:{...a,gas:m,maxFeePerGas:y,maxPriorityFeePerGas:l},from:e.address}),...a.eip712,gasPerPubdata:f,from:e.address}}},21299:(t,e,a)=>{function n(t){return`0x${t.reduce(((t,e)=>t+e.replace("0x","")),"")}`}a.r(e),a.d(e,{concatHex:()=>n})},25678:(t,e,a)=>{a.r(e),a.d(e,{connectSmartWallet:()=>kt,disconnectSmartWallet:()=>Ht,isSmartWallet:()=>St});var n=a(34316),r=a(89492),s=a(9893),i=a(38736),o=a(86511);const c="0xdd62ed3e",d=[{type:"address",name:"owner"},{type:"address",name:"spender"}],u=[{type:"uint256"}];var p=a(7911),m=a(77300),y=a(63288),l=a(83423);var f=a(21299),h=a(93300),g=a(80884),v=a(97965),G=a(25872),w=a(74074);var b=a(37131),x=a(94837),P=a(43687);const A=P.k;var L=a(22017),O=a(99577),C=a(63206),T=a(59052);const D="/docs/contract/decodeEventLog";function I(t){let{param:e,value:a}=t;if("string"===e.type||"bytes"===e.type||"tuple"===e.type||e.type.match(/^(.*)\[(\d+)?\]$/))return a;return((0,C.n)([e],a)||[])[0]}function B(t){const{abi:e,args:a,logs:n,strict:r=!0}=t,s=(()=>{if(t.eventName)return Array.isArray(t.eventName)?t.eventName:[t.eventName]})();return n.map((t=>{try{const n=e.find((e=>"event"===e.type&&t.topics[0]===A(e)));if(!n)return null;const i=function(t){const{abi:e,data:a,strict:n,topics:r}=t,s=n??!0,[i,...o]=r;if(!i)throw new v._z({docsPath:D});const c=1===e.length?e[0]:e.find((t=>"event"===t.type&&i===A((0,T.B)(t))));if(!c||!("name"in c)||"event"!==c.type)throw new v.kE(i,{docsPath:D});const{name:d,inputs:u}=c,p=u?.some((t=>!("name"in t&&t.name)));let m=p?[]:{};const y=u.filter((t=>"indexed"in t&&t.indexed));for(let h=0;h<y.length;h++){const t=y[h],e=o[h];if(!e)throw new v.l3({abiItem:c,param:t});m[p?h:t.name||h]=I({param:t,value:e})}const l=u.filter((t=>!("indexed"in t&&t.indexed)));if(l.length>0)if(a&&"0x"!==a)try{const t=(0,C.n)(l,a);if(t)if(p)m=[...m,...t];else for(let e=0;e<l.length;e++)m[l[e].name]=t[e]}catch(f){if(s){if(f instanceof v.Iy||f instanceof O.SK)throw new v.fo({abiItem:c,data:a,params:l,size:(0,L.E)(a)});throw f}}else if(s)throw new v.fo({abiItem:c,data:"0x",params:l,size:0});return{eventName:d,args:Object.values(m).length>0?m:void 0}}({...t,abi:[n],strict:r});return s&&!s.includes(i.eventName)?null:function(t){const{args:e,inputs:a,matchArgs:n}=t;if(!n)return!0;if(!e)return!1;function r(t,e,a){try{return"address"===t.type?function(t,e){if(!(0,w.P)(t,{strict:!1}))throw new G.M({address:t});if(!(0,w.P)(e,{strict:!1}))throw new G.M({address:e});return t.toLowerCase()===e.toLowerCase()}(e,a):"string"===t.type||"bytes"===t.type?(0,x.S)((0,b.ZJ)(e))===a:e===a}catch{return!1}}if(Array.isArray(e)&&Array.isArray(n))return n.every(((t,n)=>{if(null===t)return!0;const s=a[n];if(!s)return!1;return(Array.isArray(t)?t:[t]).some((t=>r(s,t,e[n])))}));return"object"===typeof e&&!Array.isArray(e)&&"object"===typeof n&&!Array.isArray(n)&&Object.entries(n).every((t=>{let[n,s]=t;if(null===s)return!0;const i=a.find((t=>t.name===n));if(!i)return!1;return(Array.isArray(s)?s:[s]).some((t=>r(i,t,e[n])))}))}({args:i.args,inputs:n.inputs,matchArgs:a})?{...i,...t}:null}catch(n){let e,a;if(n instanceof v.kE)return null;if(n instanceof v.fo||n instanceof v.l3){if(r)return null;e=n.abiItem.name,a=n.abiItem.inputs?.some((t=>!("name"in t&&t.name)))}return{...t,args:a?[]:{},eventName:e}}})).filter(Boolean)}var U=a(55907),F=a(21627);class V extends F.C{constructor(t){super(`Filter type "${t}" is not supported.`,{name:"FilterTypeNotSupportedError"})}}var $=a(31376),j=a(31499),S=a(73924);function M(t,e){const a=typeof t,n=e.type;switch(n){case"address":return(0,w.P)(t,{strict:!1});case"bool":return"boolean"===a;case"function":case"string":return"string"===a;default:return"tuple"===n&&"components"in e?Object.values(e.components).every(((e,a)=>M(Object.values(t)[a],e))):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(n)?"number"===a||"bigint"===a:/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(n)?"string"===a||t instanceof Uint8Array:!!/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(n)&&(Array.isArray(t)&&t.every((t=>M(t,{...e,type:n.replace(/(\[[0-9]{0,}\])$/,"")}))))}}function E(t,e,a){for(const n in t){const r=t[n],s=e[n];if("tuple"===r.type&&"tuple"===s.type&&"components"in r&&"components"in s)return E(r.components,s.components,a[n]);const i=[r.type,s.type];if(!(!i.includes("address")||!i.includes("bytes20"))||(i.includes("address")&&i.includes("string")||!(!i.includes("address")||!i.includes("bytes")))&&(0,w.P)(a[n],{strict:!1}))return i}}const k="/docs/contract/encodeEventTopics";function H(t){const{abi:e,eventName:a,args:n}=t;let r=e[0];if(a){const t=function(t){const{abi:e,args:a=[],name:n}=t,r=(0,j.q)(n,{strict:!1}),s=e.filter((t=>r?"function"===t.type?(0,S.V)(t)===n:"event"===t.type&&A(t)===n:"name"in t&&t.name===n));if(0===s.length)return;if(1===s.length)return s[0];let i;for(const o of s)if("inputs"in o)if(a&&0!==a.length){if(o.inputs&&0!==o.inputs.length&&o.inputs.length===a.length&&a.every(((t,e)=>{const a="inputs"in o&&o.inputs[e];return!!a&&M(t,a)}))){if(i&&"inputs"in i&&i.inputs){const t=E(o.inputs,i.inputs,a);if(t)throw new v.nM({abiItem:o,type:t[0]},{abiItem:i,type:t[1]})}i=o}}else if(!o.inputs||0===o.inputs.length)return o;return i||s[0]}({abi:e,name:a});if(!t)throw new v.M_(a,{docsPath:k});r=t}if("event"!==r.type)throw new v.M_(void 0,{docsPath:k});const s=(0,T.B)(r),i=A(s);let o=[];if(n&&"inputs"in r){const t=r.inputs?.filter((t=>"indexed"in t&&t.indexed)),e=Array.isArray(n)?n:Object.values(n).length>0?t?.map((t=>n[t.name]))??[]:[];e.length>0&&(o=t?.map(((t,a)=>Array.isArray(e[a])?e[a].map(((n,r)=>N({param:t,value:e[a][r]}))):e[a]?N({param:t,value:e[a]}):null))??[])}return[i,...o]}function N(t){let{param:e,value:a}=t;if("string"===e.type||"bytes"===e.type)return(0,x.S)((0,b.ZJ)(a));if("tuple"===e.type||e.type.match(/^(.*)\[(\d+)?\]$/))throw new V(e.type);return(0,$.h)([e],[a])}function _(t){const{signature:e}=t;let a;var n;return a=(n=e)&&"object"===typeof n&&"type"in n&&"event"===n.type?e:(0,U.$)(e),{abiEvent:a,hash:(0,P.k)(a),topics:H({abi:[a],args:t.filters})}}function W(){return _({signature:"event UserOperationRevertReason(bytes32 indexed userOpHash, address indexed sender, uint256 nonce, bytes revertReason)",filters:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}})}function z(){return _({signature:"event PostOpRevertReason(bytes32 indexed userOpHash, address indexed sender, uint256 nonce, bytes revertReason)",filters:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}})}var R=a(3340),Z=a(49703),q=a(77717);var J=a(20635),K=a(97779);const Q=()=>{const t=BigInt(Math.floor(4294967296*Math.random())),e=BigInt(Math.floor(4294967296*Math.random())),a=BigInt(Math.floor(4294967296*Math.random())),n=BigInt(Math.floor(4294967296*Math.random())),r=BigInt(Math.floor(4294967296*Math.random())),s=BigInt(Math.floor(4294967296*Math.random()));return t<<BigInt(160)|e<<BigInt(128)|a<<BigInt(96)|n<<BigInt(64)|r<<BigInt(32)|s};function Y(t){return Object.fromEntries(Object.entries(t).map((t=>{let[e,a]=t;return[e,void 0===a||null===a||(0,K.q)(a)?a:(0,R.nj)(a)]})))}async function X(t){const e=await et({...t,operation:"eth_estimateUserOperationGas",params:[Y(t.userOp),t.options.entrypointAddress??J.uh]});return{preVerificationGas:(0,R.uU)(e.preVerificationGas),verificationGas:(0,R.uU)(e.verificationGas),verificationGasLimit:(0,R.uU)(e.verificationGasLimit),callGasLimit:(0,R.uU)(e.callGasLimit)+J.L8,paymasterVerificationGasLimit:void 0!==e.paymasterVerificationGasLimit?(0,R.uU)(e.paymasterVerificationGasLimit):void 0,paymasterPostOpGasLimit:void 0!==e.paymasterPostOpGasLimit?(0,R.uU)(e.paymasterPostOpGasLimit):void 0}}async function tt(t){const e=await async function(t){const e=await et({options:t,operation:"eth_getUserOperationReceipt",params:[t.userOpHash]});if(!e)return;return function(t){const{receipt:e}=t,a={...e,transactionHash:e.transactionHash,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,contractAddress:e.contractAddress?e.contractAddress:null,cumulativeGasUsed:e.cumulativeGasUsed?BigInt(e.cumulativeGasUsed):null,effectiveGasPrice:e.effectiveGasPrice?BigInt(e.effectiveGasPrice):null,gasUsed:e.gasUsed?BigInt(e.gasUsed):null,logs:e.logs,to:e.to?e.to:null,transactionIndex:e.transactionIndex,status:e.status,type:e.type};return e.blobGasPrice&&(a.blobGasPrice=BigInt(e.blobGasPrice)),e.blobGasUsed&&(a.blobGasUsed=BigInt(e.blobGasUsed)),{...t,receipt:a,userOpHash:t.userOpHash,actualGasCost:BigInt(t.actualGasCost),actualGasUsed:BigInt(t.actualGasUsed),nonce:BigInt(t.nonce)}}(e)}(t);if(e){if(!1===e.success){const t=function(t){const{logs:e,events:a,strict:n}=t;return B({logs:e,abi:a.map((t=>t.abiEvent)),strict:n})}({events:[W(),z()],logs:e.logs}),a=t[0]?.args?.revertReason;if(!a)throw new Error(`UserOp failed at txHash: ${e.receipt.transactionHash}`);const n=(0,g.W)({data:a});throw new Error(`UserOp failed with reason: '${n.args.join(",")}' at txHash: ${e.receipt.transactionHash}`)}return e.receipt}}async function et(t){const{options:e,operation:a,params:n}=t;J.Oi&&console.debug(`>>> sending ${a} with payload:`,n);const r="v0.6"===(0,J.Fn)(e.entrypointAddress||J.uh)?"v1":"v2",s=e.bundlerUrl??(0,J.RZ)(e.chain,r),i=(0,Z.KI)(e.client),o=await i(s,{method:"POST",headers:{"Content-Type":"application/json"},body:(0,q.A)({jsonrpc:"2.0",id:1,method:a,params:n})}),c=await o.json();if(!o.ok||c.error){let t=c.error||o.statusText;"object"===typeof t&&(t=JSON.stringify(t));const e=c.code||"UNKNOWN";throw new Error(`${a} error: ${t}\nStatus: ${o.status}\nCode: ${e}`)}return J.Oi&&console.debug(`<<< ${a} result:`,c),c.result}var at=a(77877);function nt(t){const{adminAddress:e,factoryContract:a,createAccountOverride:n,accountSalt:r}=t;return n?n(a):(0,at.m)({contract:a,method:"function createAccount(address, bytes) returns (address)",params:[e,(0,R.i3)(r??"")]})}function rt(t){const{accountContract:e,transaction:a,executeOverride:n}=t;return n?n(e,a):(0,at.m)({contract:e,method:"function execute(address, uint256, bytes)",params:[a.to||"",a.value||0n,a.data||"0x"]})}var st=a(52620);const it="0x35567e1a",ot=[{type:"address",name:"sender"},{type:"uint192",name:"key"}],ct=[{type:"uint256",name:"nonce"}];const dt="0xa6193531",ut=[{type:"tuple",name:"userOp",components:[{type:"address",name:"sender"},{type:"uint256",name:"nonce"},{type:"bytes",name:"initCode"},{type:"bytes",name:"callData"},{type:"uint256",name:"callGasLimit"},{type:"uint256",name:"verificationGasLimit"},{type:"uint256",name:"preVerificationGas"},{type:"uint256",name:"maxFeePerGas"},{type:"uint256",name:"maxPriorityFeePerGas"},{type:"bytes",name:"paymasterAndData"},{type:"bytes",name:"signature"}]}],pt=[{type:"bytes32"}];const mt="0x22cdde4c",yt=[{type:"tuple",name:"userOp",components:[{type:"address",name:"sender"},{type:"uint256",name:"nonce"},{type:"bytes",name:"initCode"},{type:"bytes",name:"callData"},{type:"bytes32",name:"accountGasLimits"},{type:"uint256",name:"preVerificationGas"},{type:"bytes32",name:"gasFees"},{type:"bytes",name:"paymasterAndData"},{type:"bytes",name:"signature"}]}],lt=[{type:"bytes32"}];var ft=a(22561),ht=a(79002),gt=a(69961),vt=a(42002),Gt=a(46325),wt=a(17143),bt=a(84117);function xt(t){return(0,st.xW)([(0,wt.eV)((0,bt.nj)(t.verificationGasLimit),{size:16}),(0,wt.eV)((0,bt.nj)(t.callGasLimit),{size:16})])}function Pt(t){return(0,st.xW)([(0,wt.eV)((0,bt.nj)(t.maxPriorityFeePerGas),{size:16}),(0,wt.eV)((0,bt.nj)(t.maxFeePerGas),{size:16})])}function At(t){return t.paymaster?(0,st.xW)([t.paymaster,(0,wt.eV)((0,bt.nj)(t.paymasterVerificationGasLimit||BigInt(0)),{size:16}),(0,wt.eV)((0,bt.nj)(t.paymasterPostOpGasLimit||BigInt(0)),{size:16}),t.paymasterData||"0x"]):"0x"}const Lt=t=>{return{sender:t.sender,nonce:t.nonce,initCode:(e=t,e.factory?(0,st.xW)([e.factory,e.factoryData||"0x"]):"0x"),callData:t.callData,accountGasLimits:xt(t),preVerificationGas:t.preVerificationGas,gasFees:Pt(t),paymasterAndData:At(t),signature:t.signature};var e};async function Ot(t){const{userOp:e,paymasterOverride:a,client:n,chain:r,entrypointAddress:s}=t;if(a)return a(e);const i=s??J.uh,o="v0.6"===(0,J.Fn)(i)?"v1":"v2",c=(0,J.RZ)(r,o),d=(0,Z.KI)(n),u=await d(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:1,method:"pm_sponsorUserOperation",params:[Y(e),i]})}),p=await u.json();if(!u.ok){const t=p.error||u.statusText,e=p.code||"UNKNOWN";throw new Error(`Paymaster error: ${t}\nStatus: ${u.status}\nCode: ${e}`)}if(J.Oi&&console.debug("Paymaster result:",p),p.result)return"string"===typeof p.result?{paymasterAndData:p.result}:{paymasterAndData:p.result.paymasterAndData,verificationGasLimit:p.result.verificationGasLimit?(0,R.uU)(p.result.verificationGasLimit):void 0,preVerificationGas:p.result.preVerificationGas?(0,R.uU)(p.result.preVerificationGas):void 0,callGasLimit:p.result.callGasLimit?(0,R.uU)(p.result.callGasLimit):void 0,paymaster:p.result.paymaster,paymasterData:p.result.paymasterData,paymasterVerificationGasLimit:p.result.paymasterVerificationGasLimit?(0,R.uU)(p.result.paymasterVerificationGasLimit):void 0,paymasterPostOpGasLimit:p.result.paymasterPostOpGasLimit?(0,R.uU)(p.result.paymasterPostOpGasLimit):void 0};const m=p.error?.message||p.error||u.statusText||"unknown error";throw new Error(`Paymaster error from ${c}: ${m}`)}const Ct=new Set,Tt=t=>`${t.chain.id}:${t.address}`,Dt=t=>{Ct.add(Tt(t))},It=t=>{Ct.delete(Tt(t))},Bt=t=>Ct.has(Tt(t));async function Ut(t){const{transaction:e,accountContract:a,factoryContract:n,adminAddress:r,overrides:s,sponsorGas:i}=t,o=e.chain,c=e.client,d={client:c,chain:o,entrypointAddress:s?.entrypointAddress},u=(0,J.Fn)(t.overrides?.entrypointAddress||J.uh),[p,m,y,l]=await Promise.all([(0,gt.isContractDeployed)(a),(0,ht.encode)(e),Ft({executeTx:e,bundlerOptions:d,chain:o,client:c}),$t({accountContract:a,chain:o,client:c,entrypointAddress:s?.entrypointAddress,getNonceOverride:s?.getAccountNonce})]),{maxFeePerGas:f,maxPriorityFeePerGas:h}=y;return"v0.7"===u?async function(t){const{bundlerOptions:e,isDeployed:a,factoryContract:n,accountContract:r,adminAddress:s,sponsorGas:i,overrides:o,nonce:c,callData:d,maxFeePerGas:u,maxPriorityFeePerGas:p}=t,{chain:m,client:y}=e;let l,f;a||Bt(r)?(f="0x",await jt(r)):(l=n.address,f=await(0,ht.encode)(nt({factoryContract:n,adminAddress:s,accountSalt:o?.accountSalt,createAccountOverride:o?.createAccount})),Dt(r));const h={sender:r.address,nonce:c,callData:d,maxFeePerGas:u,maxPriorityFeePerGas:p,callGasLimit:0n,verificationGasLimit:0n,preVerificationGas:0n,factory:l,factoryData:f,paymaster:void 0,paymasterData:"0x",paymasterVerificationGasLimit:0n,paymasterPostOpGasLimit:0n,signature:J.km};if(i){const t=await Ot({userOp:h,chain:m,client:y,entrypointAddress:o?.entrypointAddress,paymasterOverride:o?.paymaster});if(t.paymaster&&t.paymasterData&&(h.paymaster=t.paymaster,h.paymasterData=t.paymasterData),t.callGasLimit&&t.verificationGasLimit&&t.preVerificationGas&&t.paymasterPostOpGasLimit&&t.paymasterVerificationGasLimit)h.callGasLimit=t.callGasLimit,h.verificationGasLimit=t.verificationGasLimit,h.preVerificationGas=t.preVerificationGas,h.paymasterPostOpGasLimit=t.paymasterPostOpGasLimit,h.paymasterVerificationGasLimit=t.paymasterVerificationGasLimit;else{const a=await X({userOp:h,options:e});h.callGasLimit=a.callGasLimit,h.verificationGasLimit=a.verificationGasLimit,h.preVerificationGas=a.preVerificationGas,h.paymasterPostOpGasLimit=t.paymasterPostOpGasLimit||0n,h.paymasterVerificationGasLimit=t.paymasterVerificationGasLimit||0n;const n=await Ot({userOp:h,chain:m,client:y,entrypointAddress:o?.entrypointAddress,paymasterOverride:o?.paymaster});n.paymaster&&n.paymasterData&&(h.paymaster=n.paymaster,h.paymasterData=n.paymasterData)}}else{const t=await X({userOp:h,options:e});h.callGasLimit=t.callGasLimit,h.verificationGasLimit=t.verificationGasLimit,h.preVerificationGas=t.preVerificationGas,h.paymasterPostOpGasLimit=t.paymasterPostOpGasLimit||0n,h.paymasterVerificationGasLimit=t.paymasterVerificationGasLimit||0n}return{...h,signature:"0x"}}({bundlerOptions:d,factoryContract:n,accountContract:a,adminAddress:r,sponsorGas:i,overrides:s,isDeployed:p,nonce:l,callData:m,maxFeePerGas:f,maxPriorityFeePerGas:h}):async function(t){const{bundlerOptions:e,isDeployed:a,factoryContract:n,accountContract:r,adminAddress:s,sponsorGas:i,overrides:o,nonce:c,callData:d,maxFeePerGas:u,maxPriorityFeePerGas:p}=t,{chain:m,client:y}=e;let l;a||Bt(r)?(l="0x",await jt(r)):(l=await async function(t){const{factoryContract:e,adminAddress:a,accountSalt:n,createAccountOverride:r}=t,s=nt({factoryContract:e,adminAddress:a,accountSalt:n,createAccountOverride:r});return(0,st.xW)([e.address,await(0,ht.encode)(s)])}({factoryContract:n,adminAddress:s,accountSalt:o?.accountSalt,createAccountOverride:o?.createAccount}),Dt(r));const f={sender:r.address,nonce:c,initCode:l,callData:d,maxFeePerGas:u,maxPriorityFeePerGas:p,callGasLimit:0n,verificationGasLimit:0n,preVerificationGas:0n,paymasterAndData:"0x",signature:J.km};if(i){const t=await Ot({userOp:f,chain:m,client:y,entrypointAddress:o?.entrypointAddress,paymasterOverride:o?.paymaster}),a="paymasterAndData"in t?t.paymasterAndData:"0x";if(a&&"0x"!==a&&(f.paymasterAndData=a),t.callGasLimit&&t.verificationGasLimit&&t.preVerificationGas)f.callGasLimit=t.callGasLimit,f.verificationGasLimit=t.verificationGasLimit,f.preVerificationGas=t.preVerificationGas;else{const t=await X({userOp:f,options:e});if(f.callGasLimit=t.callGasLimit,f.verificationGasLimit=t.verificationGasLimit,f.preVerificationGas=t.preVerificationGas,a&&"0x"!==a){const t=await Ot({userOp:f,chain:m,client:y,entrypointAddress:o?.entrypointAddress,paymasterOverride:o?.paymaster}),e="paymasterAndData"in t?t.paymasterAndData:"0x";e&&"0x"!==e&&(f.paymasterAndData=e)}}}else{const t=await X({userOp:f,options:e});f.callGasLimit=t.callGasLimit,f.verificationGasLimit=t.verificationGasLimit,f.preVerificationGas=t.preVerificationGas}return{...f,signature:"0x"}}({bundlerOptions:d,factoryContract:n,accountContract:a,adminAddress:r,sponsorGas:i,overrides:s,isDeployed:p,nonce:l,callData:m,maxFeePerGas:f,maxPriorityFeePerGas:h})}async function Ft(t){const{executeTx:e,bundlerOptions:a,chain:n,client:r}=t;let{maxFeePerGas:s,maxPriorityFeePerGas:i}=e;const o="v0.6"===(0,J.Fn)(a.entrypointAddress||J.uh)?"v1":"v2",c=a?.bundlerUrl??(0,J.RZ)(n,o);if((0,Z.Lj)(c)){const t=await async function(t){const e=await et({...t,operation:"thirdweb_getUserOperationGasPrice",params:[]});return{maxPriorityFeePerGas:(0,R.uU)(e.maxPriorityFeePerGas),maxFeePerGas:(0,R.uU)(e.maxFeePerGas)}}({options:a});s=t.maxFeePerGas,i=t.maxPriorityFeePerGas}else{const[t,e]=await Promise.all([(0,Gt.r)(s),(0,Gt.r)(i)]);if(t&&e)s=t,i=e;else{const a=await(0,ft.G)(r,n);i=e??a.maxPriorityFeePerGas??0n,s=t??a.maxFeePerGas??0n}}return{maxFeePerGas:s,maxPriorityFeePerGas:i}}async function Vt(t){const{userOp:e,chain:a,entrypointAddress:n,adminAccount:r}=t;let s;if("v0.7"===(0,J.Fn)(n||J.uh)){const r=Lt(e);s=await async function(t){return(0,o.readContract)({contract:t.contract,method:[mt,yt,lt],params:[t.userOp]})}({contract:(0,i.P)({address:n||J.nF,chain:a,client:t.client}),userOp:r})}else s=await async function(t){return(0,o.readContract)({contract:t.contract,method:[dt,ut,pt],params:[t.userOp]})}({contract:(0,i.P)({address:n||J.uh,chain:a,client:t.client}),userOp:e});if(r.signMessage){const t=await r.signMessage({message:{raw:(0,vt.aT)(s)}});return{...e,signature:t}}throw new Error("signMessage not implemented in signingAccount")}async function $t(t){const{accountContract:e,chain:a,client:n,entrypointAddress:r,getNonceOverride:s}=t;return s?s(e):async function(t){return(0,o.readContract)({contract:t.contract,method:[it,ot,ct],params:[t.sender,t.key]})}({contract:(0,i.P)({address:r||J.uh,chain:a,client:n}),key:Q(),sender:e.address})}async function jt(t){const e=Date.now();for(;Bt(t);){if(Date.now()-e>6e4)throw new Error("Account deployment is taking too long (over 1 minute). Please try again.");await new Promise((t=>setTimeout(t,500)))}}function St(t){return"smart"===t.id}const Mt=new WeakMap,Et=new WeakMap;async function kt(t,e,s){const{personalAccount:y,client:g,chain:v}=e;if(!y)throw new Error("Personal wallet does not have an account");const G=s,w=G.factoryAddress??(0,J.Fd)(s.overrides?.entrypointAddress),b=v??G.chain,x="gasless"in G?G.gasless:G.sponsorGas;if(function(t){return 324===t.id||300===t.id||302===t.id||11124===t.id}(b))return[Nt({creationOptions:s,connectionOptions:e,chain:b,sponsorGas:x}),b];const P=(0,i.P)({client:g,address:w,chain:b}),A=await async function(t){const{factoryContract:e,predictAddressOverride:a,adminAddress:n,accountSalt:r,accountAddress:s}=t;if(a)return a(e);if(s)return s;if(!n)throw new Error("Account address is required to predict the smart wallet address.");const i=(0,R.i3)(r??"");return(0,o.readContract)({contract:e,method:"function getAddress(address, bytes) returns (address)",params:[n,i]})}({factoryContract:P,adminAddress:y.address,predictAddressOverride:G.overrides?.predictAddress,accountSalt:G.overrides?.accountSalt,accountAddress:G.overrides?.accountAddress}).then((t=>t)).catch((t=>{throw new Error(`Failed to get account address with factory contract ${P.address} on chain ID ${b.id}: ${t?.message||"unknown error"}`,{cause:t})})),L=(0,i.P)({client:g,address:A,chain:b}),O=await async function(t){const{accountContract:e}=t,s={address:(0,l.bv)(e.address),async sendTransaction(a){const n=t.overrides?.erc20Paymaster;let s;if(n){await async function(t){const{accountContract:e,erc20Paymaster:a,options:n}=t,s=a.token,y=(0,i.P)({address:s,chain:e.chain,client:e.client}),l=await async function(t){return(0,o.readContract)({contract:t.contract,method:[c,d,u],params:[t.owner,t.spender]})}({contract:y,owner:e.address,spender:a.address});if(l>0n)return;const f=(0,p.S)({contract:y,spender:a.address,amountWei:r.EA-1n}),h=await(0,m.$)({transaction:f,from:e.address}),g=rt({accountContract:e,transaction:h,executeOverride:n.overrides?.execute});await Wt({executeTx:g,options:{...n,overrides:{...n.overrides,erc20Paymaster:void 0}}})}({accountContract:e,erc20Paymaster:n,options:t});const a=async()=>({paymasterAndData:(0,f.concatHex)([n.address,n?.token]),paymaster:n.address,paymasterData:"0x"});s=t.overrides?.paymaster||a}return Wt({executeTx:rt({accountContract:e,transaction:a,executeOverride:t.overrides?.execute}),options:{...t,overrides:{...t.overrides,paymaster:s}}})},async sendBatchTransaction(a){const n=function(t){const{accountContract:e,transactions:a,executeBatchOverride:n}=t;return n?n(e,a):(0,at.m)({contract:e,method:"function executeBatch(address[], uint256[], bytes[])",params:[a.map((t=>t.to||"")),a.map((t=>t.value||0n)),a.map((t=>t.data||"0x"))]})}({accountContract:e,transactions:a,executeBatchOverride:t.overrides?.executeBatch});return Wt({executeTx:n,options:t})},async signMessage(n){let{message:r}=n;const[{isContractDeployed:i},{readContract:o},{encodeAbiParameters:c},{hashMessage:d},{checkContractWalletSignature:u}]=await Promise.all([Promise.resolve().then(a.bind(a,69961)),Promise.resolve().then(a.bind(a,86511)),Promise.resolve().then(a.bind(a,28482)),a.e(67143).then(a.bind(a,67143)),a.e(76603).then(a.bind(a,76603))]);await i(e)||await _t({options:t,account:s,accountContract:e});const p=d(r);let m,y=!1;try{await o({contract:e,method:"function getMessageHash(bytes32 _hash) public view returns (bytes32)",params:[p]}),y=!0}catch{}if(y){const a=c([{type:"bytes32"}],[p]);m=await t.personalAccount.signTypedData({domain:{name:"Account",version:"1",chainId:t.chain.id,verifyingContract:e.address},primaryType:"AccountMessage",types:{AccountMessage:[{name:"message",type:"bytes"}]},message:{message:a}})}else m=await t.personalAccount.signMessage({message:r});if(await u({contract:e,message:r,signature:m}))return m;throw new Error("Unable to verify signature on smart account, please make sure the smart account is deployed and the signature is valid.")},async signTypedData(r){const i=(0,h.y)(r),[{isContractDeployed:o},{readContract:c},{encodeAbiParameters:d},{checkContractWalletSignedTypedData:u}]=await Promise.all([Promise.resolve().then(a.bind(a,69961)),Promise.resolve().then(a.bind(a,86511)),Promise.resolve().then(a.bind(a,28482)),a.e(48143).then(a.bind(a,48143))]);if(i.domain?.verifyingContract?.toLowerCase()===e.address?.toLowerCase())return t.personalAccount.signTypedData(i);await o(e)||await _t({options:t,account:s,accountContract:e});const p=(0,n.Zh)(i);let m,y=!1;try{await c({contract:e,method:"function getMessageHash(bytes32 _hash) public view returns (bytes32)",params:[p]}),y=!0}catch{}if(y){const a=d([{type:"bytes32"}],[p]);m=await t.personalAccount.signTypedData({domain:{name:"Account",version:"1",chainId:t.chain.id,verifyingContract:e.address},primaryType:"AccountMessage",types:{AccountMessage:[{name:"message",type:"bytes"}]},message:{message:a}})}else m=await t.personalAccount.signTypedData(i);if(await u({contract:e,data:i,signature:m}))return m;throw new Error("Unable to verify signature on smart account, please make sure the smart account is deployed and the signature is valid.")},onTransactionRequested:async e=>t.personalAccount.onTransactionRequested?.(e)};return s}({...G,chain:b,sponsorGas:x,personalAccount:y,accountContract:L,factoryContract:P,client:g});return Mt.set(y,t),Et.set(t,y),[O,b]}async function Ht(t){const e=Et.get(t);e&&(Mt.delete(e),Et.delete(t))}function Nt(t){const{creationOptions:e,connectionOptions:a,chain:n}=t,r={address:a.personalAccount.address,async sendTransaction(i){const o={data:i.data,to:i.to??void 0,value:i.value??0n,chain:(0,s.Q4)(i.chainId),client:a.client};let c=await(0,y.f)({account:r,transaction:o});if(t.sponsorGas){const t=await async function(t){const e=await et({options:t.options,operation:"zk_paymasterData",params:[t.transaction]});return{paymaster:e.paymaster,paymasterInput:e.paymasterInput}}({options:{client:a.client,chain:n,bundlerUrl:e.overrides?.bundlerUrl,entrypointAddress:e.overrides?.entrypointAddress},transaction:c});c={...c,...t}}const d=await(0,y.a)({account:r,chainId:n.id,eip712Transaction:c}),u=await async function(t){return{transactionHash:(await et({options:t.options,operation:"zk_broadcastTransaction",params:[{...t.transaction,signedTransaction:t.signedTransaction}]})).transactionHash}}({options:{client:a.client,chain:n,bundlerUrl:e.overrides?.bundlerUrl,entrypointAddress:e.overrides?.entrypointAddress},transaction:c,signedTransaction:d});return{transactionHash:u.transactionHash,client:a.client,chain:n}},async signMessage(t){let{message:e}=t;return a.personalAccount.signMessage({message:e})},async signTypedData(t){const e=(0,h.y)(t);return a.personalAccount.signTypedData(e)},onTransactionRequested:async t=>a.personalAccount.onTransactionRequested?.(t)};return r}async function _t(t){const{options:e,account:n,accountContract:r}=t,[{sendTransaction:s},{prepareTransaction:i}]=await Promise.all([Promise.resolve().then(a.bind(a,96223)),Promise.resolve().then(a.bind(a,21300))]),o=i({client:e.client,chain:e.chain,to:r.address,value:0n,gas:50000n});return await s({transaction:o,account:n})}async function Wt(t){const{executeTx:e,options:a}=t,n=await Ut({transaction:e,factoryContract:a.factoryContract,accountContract:a.accountContract,adminAddress:a.personalAccount.address,sponsorGas:a.sponsorGas,overrides:a.overrides}),r=await Vt({client:a.client,chain:a.chain,adminAccount:a.personalAccount,entrypointAddress:a.overrides?.entrypointAddress,userOp:n}),s={chain:a.chain,client:a.client,bundlerUrl:a.overrides?.bundlerUrl,entrypointAddress:a.overrides?.entrypointAddress},i=await async function(t){return et({...t,operation:"eth_sendUserOperation",params:[Y(t.userOp),t.options.entrypointAddress??J.uh]})}({options:s,userOp:r}),o=await async function(t){const e=t.timeoutMs||12e4,a=t.intervalMs||1e3,n=Date.now()+e;for(;Date.now()<n;){const e=await tt(t);if(e)return e;await new Promise((t=>setTimeout(t,a)))}throw new Error("Timeout waiting for userOp to be mined")}({...a,userOpHash:i});return It(a.accountContract),{client:a.client,chain:a.chain,transactionHash:o.transactionHash}}},89492:(t,e,a)=>{a.d(e,{Ao:()=>s,Au:()=>n,EA:()=>r});const n=65535n,r=2n**96n-1n,s=2n**256n-1n},77378:(t,e,a)=>{a.d(e,{EQ:()=>o});var n=a(21627),r=a(30751),s=a(37131),i=a(84117);function o(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hex";const a=c(t),n=(0,r.l)(new Uint8Array(a.length));return a.encode(n),"hex"===e?(0,i.My)(n.bytes):n.bytes}function c(t){return Array.isArray(t)?function(t){const e=t.reduce(((t,e)=>t+e.length),0),a=d(e);return{length:e<=55?1+e:1+a+e,encode(n){e<=55?n.pushByte(192+e):(n.pushByte(247+a),1===a?n.pushUint8(e):2===a?n.pushUint16(e):3===a?n.pushUint24(e):n.pushUint32(e));for(const{encode:e}of t)e(n)}}}(t.map((t=>c(t)))):function(t){const e="string"===typeof t?(0,s.aT)(t):t,a=d(e.length),n=1===e.length&&e[0]<128?1:e.length<=55?1+e.length:1+a+e.length;return{length:n,encode(t){1===e.length&&e[0]<128?t.pushBytes(e):e.length<=55?(t.pushByte(128+e.length),t.pushBytes(e)):(t.pushByte(183+a),1===a?t.pushUint8(e.length):2===a?t.pushUint16(e.length):3===a?t.pushUint24(e.length):t.pushUint32(e.length),t.pushBytes(e))}}}(t)}function d(t){if(t<256)return 1;if(t<65536)return 2;if(t<2**24)return 3;if(t<2**32)return 4;throw new n.C("Length is too large.")}},11907:(t,e,a)=>{a.d(e,{s:()=>o});var n=a(98780),r=a(31499),s=a(37131),i=a(84117);function o(t,e){const a=e||"hex",o=(0,n.s)((0,r.q)(t,{strict:!1})?(0,s.ZJ)(t):t);return"bytes"===a?o:(0,i.nj)(o)}},34316:(t,e,a)=>{a.d(e,{Zh:()=>c});var n=a(31376),r=a(52620),s=a(84117),i=a(94837),o=a(33998);function c(t){const{domain:e={},message:a,primaryType:n}=t,s={EIP712Domain:(0,o.H4)({domain:e}),...t.types};(0,o.$$)({domain:e,message:a,primaryType:n,types:s});const c=["0x1901"];return e&&c.push(function(t){let{domain:e,types:a}=t;return d({data:e,primaryType:"EIP712Domain",types:a})}({domain:e,types:s})),"EIP712Domain"!==n&&c.push(d({data:a,primaryType:n,types:s})),(0,i.S)((0,r.xW)(c))}function d(t){let{data:e,primaryType:a,types:n}=t;const r=u({data:e,primaryType:a,types:n});return(0,i.S)(r)}function u(t){let{data:e,primaryType:a,types:r}=t;const s=[{type:"bytes32"}],i=[p({primaryType:a,types:r})];for(const n of r[a]){const[t,a]=y({types:r,name:n.name,type:n.type,value:e[n.name]});s.push(t),i.push(a)}return(0,n.h)(s,i)}function p(t){let{primaryType:e,types:a}=t;const n=(0,s.nj)(function(t){let{primaryType:e,types:a}=t,n="";const r=m({primaryType:e,types:a});r.delete(e);const s=[e,...Array.from(r).sort()];for(const i of s)n+=`${i}(${a[i].map((t=>{let{name:e,type:a}=t;return`${a} ${e}`})).join(",")})`;return n}({primaryType:e,types:a}));return(0,i.S)(n)}function m(t){let{primaryType:e,types:a}=t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;const r=e.match(/^\w*/u),s=r?.[0];if(n.has(s)||void 0===a[s])return n;n.add(s);for(const i of a[s])m({primaryType:i.type,types:a},n);return n}function y(t){let{types:e,name:a,type:r,value:o}=t;if(void 0!==e[r])return[{type:"bytes32"},(0,i.S)(u({data:o,primaryType:r,types:e}))];if("bytes"===r){return o=`0x${(o.length%2?"0":"")+o.slice(2)}`,[{type:"bytes32"},(0,i.S)(o)]}if("string"===r)return[{type:"bytes32"},(0,i.S)((0,s.nj)(o))];if(r.lastIndexOf("]")===r.length-1){const t=r.slice(0,r.lastIndexOf("[")),s=o.map((n=>y({name:a,type:t,types:e,value:n})));return[{type:"bytes32"},(0,i.S)((0,n.h)(s.map((t=>{let[e]=t;return e})),s.map((t=>{let[,e]=t;return e}))))]}return[{type:r},o]}}}]);
//# sourceMappingURL=25678.f26b18e8.chunk.js.map