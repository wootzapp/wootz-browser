"use strict";(self.webpackChunkrewards=self.webpackChunkrewards||[]).push([[39674,8576,3355],{79578:(e,t,n)=>{n.d(t,{rr:()=>a});var s=n(86511);const o="0x313ce567",r=[],i=[{type:"uint8"}];async function a(e){return(0,s.readContract)({contract:e.contract,method:[o,r,i],params:[]})}},8576:(e,t,n)=>{n.d(t,{decimals:()=>r});var s=n(27059),o=n(79578);async function r(e){return(0,s.n)((()=>(0,o.rr)(e)),{cacheKey:`${e.contract.chain.id}:${e.contract.address}:decimals`,cacheTime:Number.POSITIVE_INFINITY})}},3355:(e,t,n)=>{n.d(t,{getCurrencyMetadata:()=>p});var s=n(28887),o=n(27059),r=n(86511);const i="0x06fdde03",a=[],c=[{type:"string"}];async function d(e){return(0,o.n)((()=>async function(e){return(0,r.readContract)({contract:e.contract,method:[i,a,c],params:[]})}(e)),{cacheKey:`${e.contract.chain.id}:${e.contract.address}:name`,cacheTime:Number.POSITIVE_INFINITY})}const l="0x95d89b41",u=[],h=[{type:"string"}];async function m(e){return(0,o.n)((()=>async function(e){return(0,r.readContract)({contract:e.contract,method:[l,u,h],params:[]})}(e)),{cacheKey:`${e.contract.chain.id}:${e.contract.address}:symbol`,cacheTime:Number.POSITIVE_INFINITY})}var x=n(79578);async function p(e){if((0,s.dw)(e.contract.address))return{name:"Ether",symbol:"ETH",decimals:18,...e.contract.chain.nativeCurrency};try{const[t,n,s]=await Promise.all([d(e).catch((()=>"")),m(e),(0,x.rr)(e)]);return{name:t,symbol:n,decimals:s}}catch{throw new Error("Invalid currency token")}}},39674:(e,t,n)=>{n.r(t),n.d(t,{default:()=>kt});var s=n(70579),o=n(90852),r=n(63248),i=n(65043),a=n(96969),c=n(28887),d=n(83423);function l(e){const t=e.toToken.chainId===e.onRampToken.token.chainId,n=(0,d.bv)(e.toToken.tokenAddress)===(0,d.bv)(e.onRampToken.token.tokenAddress);return!(t&&n)}var u=n(55397),h=n(73310),m=n(70012),x=n(12265),p=n(89516);var y=n(49703),f=n(39680);function j(e,t){return(0,x.I)({...t,queryKey:["useBuyWithFiatQuote",e],queryFn:async()=>{if(!e)throw new Error("No params provided");return async function(e){try{const t=(0,y.KI)(e.client),n=await t((0,f._5)(),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({toAddress:e.toAddress,fromCurrencySymbol:e.fromCurrencySymbol,toChainId:e.toChainId.toString(),toTokenAddress:e.toTokenAddress,fromAmount:e.fromAmount,toAmount:e.toAmount,maxSlippageBPS:e.maxSlippageBPS,isTestMode:e.isTestMode,purchaseData:e.purchaseData,fromAddress:e.fromAddress,toGasAmountWei:e.toGasAmountWei,preferredProvider:e.preferredProvider})});if(!n.ok){const e=await n.json();if(e&&"error"in e)throw e;throw new Error(`HTTP error! status: ${n.status}`)}return(await n.json()).result}catch(t){throw console.error("Error getting buy with fiat quote",t),t}}(e)},enabled:!!e,retry(e,t){if(e>3)return!1;try{const e=t.error;if("MINIMUM_PURCHASE_AMOUNT"===e.code)return!1;if(404===e.statusCode||e.statusCode>=500)return!1}catch{return!0}return!0}})}var g=n(41679),w=n(85892),b=n(43571),k=n(2038),C=n(83290),T=n(56703),S=n(83609),v=n(58911),A=n(99606),E=n(25637),R=n(14494),W=n(34153);const z=(0,i.forwardRef)((function(e,t){return(0,s.jsx)(O,{ref:t,children:(0,s.jsx)(A.X,{children:(0,s.jsxs)(R.mc,{p:"lg",children:[(0,s.jsx)(E.w,{children:(0,s.jsx)(W.K0,{type:"button","aria-label":"Close",onClick:e.close,children:(0,s.jsx)(o.MKb,{width:h.RK.md,height:h.RK.md,style:{color:"inherit"}})})}),e.children]})})})})),O=(0,v.jx)((e=>{const t=(0,T.QP)();return{zIndex:1e4,borderTopLeftRadius:h.r8.xl,borderTopRightRadius:h.r8.xl,background:t.colors.modalBg,position:"absolute",bottom:0,left:0,right:0,animation:`${I} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.1)`,borderTop:`1px solid ${t.colors.borderColor}`}})),I=C.i7`
  from {
    opacity: 0;
    transform: translateY(100px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
`,B=(0,v.jx)((e=>({backgroundColor:(0,T.QP)().colors.modalOverlayBg,zIndex:9999,position:"absolute",inset:0,animation:`${S.I0} 400ms cubic-bezier(0.16, 1, 0.3, 1)`})));function F(){const[e,t]=(0,i.useState)(!1),n=(0,i.useRef)(null),s=(0,i.useRef)(null),o=(0,i.useCallback)((()=>new Promise((e=>{if(n.current){const t={easing:"cubic-bezier(0.175, 0.885, 0.32, 1.1)",fill:"forwards",duration:300},o=n.current.animate([{transform:"translateY(100%)",opacity:0}],t);s.current?.animate([{opacity:0}],t),o.onfinish=()=>e()}else e()}))),[]),r=(0,i.useCallback)((async e=>{e?t(!0):(await o(),t(!1))}),[o]);return(0,i.useLayoutEffect)((()=>{if(!e)return;const t=e=>{n.current&&e.target instanceof Node&&!n.current.contains(e.target)&&r(!1)};return requestAnimationFrame((()=>{document.addEventListener("click",t)})),()=>{document.removeEventListener("click",t)}}),[e,r]),{drawerRef:n,drawerOverlayRef:s,setIsOpen:r,isOpen:e}}var D=n(4230),P=n(5961),L=n(97138),K=n(46025),N=n(67991),M=n(96292),q=n(31476),_=n(88957),$=n(88760),H=n(48971),U=n(38437),Y=n(38736),G=n(8576),V=n(99108),Q=n(64185),Z=n(57855),J=n(37529),X=n(13776),ee=n(35739),te=n(58572),ne=n(4242);function se(e){const{payUiOptions:t,supportedDestinations:n,client:o,onContinue:r,payerAccount:i}=e,l=(0,T.QP)(),m=(0,Z.z)(),p=t.metadata,y=t.paymentInfo,{data:f}=(0,Q.cj)(y.chain),{data:j}=(0,J.vq)({client:o,address:y.sellerAddress}),g=(0,x.I)({queryKey:["amount",y],queryFn:async()=>{let e,t=18;return y.token&&!(0,U.r)(y.token)&&(t=await(0,G.decimals)({contract:(0,Y.P)({address:y.token.address,chain:y.chain,client:o})})),e="amountWei"in y?(0,V.ow)(y.amountWei,t):y.amount,e}}).data;if(!f||void 0===g)return(0,s.jsx)(b.x,{});const w=y.token?{...y.token,icon:y.token?.icon||n.find((e=>e.chain.id===y.chain.id))?.tokens.find((e=>e.address.toLowerCase()===y.token?.address.toLowerCase()))?.icon}:{address:c.DG,name:f.nativeCurrency.name,symbol:f.nativeCurrency.symbol,icon:f.icon?.url};return(0,s.jsxs)(R.mc,{p:"lg",children:[(0,s.jsx)(R.rQ,{title:p?.name||"Payment Details"}),(0,s.jsx)(D.h,{y:"lg"}),(0,s.jsxs)(R.mc,{children:[p?.image?(0,s.jsx)(ee.E,{client:o,src:p?.image,style:{width:"100%",borderRadius:h.YK.md,backgroundColor:l.colors.tertiaryBg}}):m?(0,s.jsxs)(R.mc,{flex:"row",center:"both",style:{padding:h.YK.md,marginBottom:h.YK.md,borderRadius:h.YK.md,backgroundColor:l.colors.tertiaryBg},children:[(0,s.jsx)(ne.j,{size:h.RK.xl,id:m.id,client:o}),(0,s.jsx)("div",{style:{flexGrow:1,borderBottom:"6px dotted",borderColor:l.colors.secondaryIconColor,marginLeft:h.YK.md,marginRight:h.YK.md}}),(0,s.jsx)(X.P,{client:o,size:h.RK.xl,chainIconUrl:f.icon?.url})]}):null,(0,s.jsx)(D.h,{y:"md"}),(0,s.jsxs)(R.mc,{flex:"row",children:[(0,s.jsx)(R.mc,{flex:"column",expand:!0,children:(0,s.jsx)(K.E,{size:"md",color:"primaryText",weight:700,children:"Price"})}),(0,s.jsx)(R.mc,{expand:!0,children:(0,s.jsxs)(R.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,s.jsx)(te.x,{chain:y.chain,client:e.client,size:"sm",token:w}),(0,s.jsxs)(K.E,{color:"primaryText",size:"md",weight:700,children:[String((0,u.Z)(Number(g),6))," ",w.symbol]})]})})]}),(0,s.jsx)(D.h,{y:"md"}),(0,s.jsx)(R.N1,{}),(0,s.jsx)(D.h,{y:"md"}),(0,s.jsxs)(R.mc,{flex:"row",children:[(0,s.jsx)(R.mc,{flex:"column",expand:!0,children:(0,s.jsx)(K.E,{size:"xs",color:"secondaryText",children:"Network"})}),(0,s.jsx)(R.mc,{expand:!0,children:(0,s.jsxs)(R.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,s.jsx)(X.P,{chainIconUrl:f.icon?.url,size:"xs",client:e.client}),(0,s.jsx)(K.E,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:f.name})]})})]}),(0,s.jsx)(D.h,{y:"sm"}),(0,s.jsxs)(R.mc,{flex:"row",children:[(0,s.jsx)(R.mc,{flex:"column",expand:!0,children:(0,s.jsx)(K.E,{size:"xs",color:"secondaryText",children:"Seller"})}),(0,s.jsx)(R.mc,{expand:!0,children:(0,s.jsx)(R.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:(0,s.jsx)(K.E,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:j||(0,d.Wr)(y.sellerAddress)})})})]})]}),(0,s.jsx)(D.h,{y:"xl"}),i?(0,s.jsx)(W.$n,{variant:"accent",fullWidth:!0,onClick:()=>{(0,a.G)({event:"choose_payment_method_direct_payment_mode",client:o,walletAddress:i.address,walletType:m?.id}),r(g,y.chain,w)},children:"Choose Payment Method"}):(0,s.jsx)("div",{children:(0,s.jsx)(M.p,{...e.connectOptions,client:o,theme:l,connectButton:{style:{width:"100%"}}})})]})}var oe=n(21969),re=n(53436);function ie(e){const{estimatedSeconds:t,quoteIsLoading:n}=e;return(0,s.jsxs)(R.mc,{bg:"tertiaryBg",flex:"row",borderColor:"borderColor",style:{borderRadius:h.r8.md,borderTopLeftRadius:0,borderTopRightRadius:0,justifyContent:"space-between",alignItems:"center",borderWidth:"1px",borderStyle:"solid"},children:[(0,s.jsxs)(R.mc,{flex:"row",center:"y",gap:"xxs",color:"accentText",p:"sm",children:[(0,s.jsx)(o.O4,{width:h.RK.sm,height:h.RK.sm}),n?(0,s.jsx)(oe.E,{height:h.J.xs,width:"50px",color:"borderColor"}):(0,s.jsx)(K.E,{size:"xs",color:"secondaryText",children:void 0!==t?`~${(0,re.X)(t)}`:"--"})]}),(0,s.jsxs)(W.$n,{variant:"ghost",onClick:e.onViewFees,gap:"xs",children:[(0,s.jsx)(R.mc,{color:"accentText",flex:"row",center:"both",children:(0,s.jsx)(ae,{size:h.RK.sm})}),(0,s.jsx)(K.E,{size:"xs",color:"secondaryText",children:"View Fees"})]})]})}const ae=e=>(0,s.jsxs)("svg",{width:e.size,height:e.size,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[(0,s.jsx)("path",{d:"M9.5 1.5H2.5C1.94772 1.5 1.5 1.94772 1.5 2.5V9.5C1.5 10.0523 1.94772 10.5 2.5 10.5H9.5C10.0523 10.5 10.5 10.0523 10.5 9.5V2.5C10.5 1.94772 10.0523 1.5 9.5 1.5Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M4.5 7.5L7.5 4.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]});var ce=n(59350),de=n(42156);function le(e){return(0,s.jsxs)(R.mc,{bg:"tertiaryBg",borderColor:"borderColor",flex:"row",style:{borderRadius:h.r8.md,borderBottomRightRadius:0,borderBottomLeftRadius:0,borderWidth:"1px",borderStyle:"solid",borderBottom:"none",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsxs)(ue,{variant:"ghost",onClick:e.onSelectCurrency,style:{minHeight:"64px",justifyContent:"flex-start",minWidth:"50%"},gap:"sm",children:[(0,s.jsx)(e.currency.icon,{size:h.RK.md}),(0,s.jsxs)(R.mc,{flex:"row",center:"y",gap:"xxs",color:"secondaryText",children:[(0,s.jsx)(K.E,{color:"primaryText",children:e.currency.shorthand}),(0,s.jsx)(o.D3D,{width:h.RK.sm,height:h.RK.sm})]})]}),(0,s.jsx)("div",{style:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:h.YK.xxs,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",justifyContent:"center",paddingRight:h.YK.sm},children:e.isLoading?(0,s.jsx)(oe.E,{width:"100px",height:h.J.lg}):(0,s.jsx)(K.E,{size:"lg",color:e.value?"primaryText":"secondaryText",children:e.value?`${(0,u.Z)(Number(e.value),6)}`:"--"})})]})}const ue=(0,de.A)(W.$n)((()=>({"&[disabled]:hover":{borderColor:"transparent"}})));var he=n(9893),me=n(3355),xe=n(39598),pe=n(79002);const ye=(0,he.xH)({id:84532,name:"Base Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},blockExplorers:[{name:"Basescan",url:"https://sepolia.basescan.org",apiUrl:"https://api-sepolia.basescan.org/api"}],testnet:!0}),fe=(0,he.xH)({id:8453,name:"Base",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockExplorers:[{name:"Basescan",url:"https://basescan.org",apiUrl:"https://api.basescan.org/api"}]}),je=(0,he.xH)({id:11155420,name:"OP Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},blockExplorers:[{name:"Blockscout",url:"https://optimism-sepolia.blockscout.com",apiUrl:"https://optimism-sepolia.blockscout.com/api"}],testnet:!0}),ge=(0,he.xH)({id:10,name:"OP Mainnet",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockExplorers:[{name:"Optimism Explorer",url:"https://optimistic.etherscan.io",apiUrl:"https://api-optimistic.etherscan.io"}]}),we=(0,he.xH)({id:999999999,name:"Zora Sepolia",nativeCurrency:{decimals:18,name:"Zora Sepolia",symbol:"ETH"},blockExplorers:[{name:"Zora Sepolia Explorer",url:"https://sepolia.explorer.zora.energy/",apiUrl:"https://sepolia.explorer.zora.energy/api"}],testnet:!0}),be=(0,he.xH)({id:7777777,name:"Zora",nativeCurrency:{decimals:18,name:"Ether",symbol:"ETH"},blockExplorers:[{name:"Explorer",url:"https://explorer.zora.energy",apiUrl:"https://explorer.zora.energy/api"}]}),ke=[fe.id,ye.id,ge.id,je.id,be.id,we.id,34443,919,42220,44787,204,5611];var Ce=n(46325),Te=n(49797);async function Se(e){const{transaction:t}=e,s=e.from??e.account?.address??void 0,o=await(0,Ce.r)(t.gas)||await(0,Te.Q)({transaction:t,from:s}),r=await(0,xe.L)({client:t.client,chain:t.chain});let i;if(a=t.chain,ke.includes(a.id)){const{estimateL1Fee:e}=await n.e(48813).then(n.bind(n,48813));i=await e({transaction:t})}else i=0n;var a;const c=o*r+i;return{ether:(0,V.Ce)(c),wei:c}}var ve=n(3791);async function Ae(e,t){try{const n=await Se({transaction:e,from:t}),s=n.wei/10n;return n.wei+s}catch{if(t)return await Ae(e);return 2000000n*await(0,xe.L)({client:e.client,chain:e.chain})}}function Ee(e){const{payUiOptions:t,client:n,payerAccount:o,supportedDestinations:r,onContinue:d}=e,{data:l}=(0,Q.cj)(t.transaction.chain),m=t.metadata,{data:p}=function(e){const{transaction:t,account:n,supportedDestinations:s}=e,[o,r]=(0,i.useState)();return(0,i.useEffect)((()=>{Promise.all([(0,Ce.r)(t.value),(0,Ce.r)(t.erc20Value),(0,Ce.r)(t.to),(0,pe.encode)(t)]).then((e=>{let[t,n,s,o]=e;r({value:t?.toString(),erc20Value:n?.amountWei?.toString(),erc20Currency:n?.tokenAddress,to:s,data:o})}))}),[t]),(0,x.I)({queryKey:["transaction-cost",t.chain.id,n?.address,o],queryFn:async()=>{if(!n)throw new Error("No account");const e=await(0,Ce.r)(t.erc20Value);if(e){const[o,r,i]=await Promise.all([(0,ve.m)({address:n.address,chain:t.chain,client:t.client,tokenAddress:e.tokenAddress}),(0,me.getCurrencyMetadata)({contract:(0,Y.P)({address:e.tokenAddress,chain:t.chain,client:t.client})}),Ae(t,n?.address)]),a=e.amountWei,c=o;return{token:{address:e.tokenAddress,name:r.name,symbol:r.symbol,icon:s.find((e=>e.chain.id===t.chain.id))?.tokens.find((t=>t.address.toLowerCase()===e.tokenAddress.toLowerCase()))?.icon},decimals:r.decimals,walletBalance:c,gasCostWei:i,transactionValueWei:a}}const[o,r,i]=await Promise.all([(0,ve.m)({address:n.address,chain:t.chain,client:t.client}),(0,he.PB)(t.chain),Ae(t,n?.address)]),a=o,d=await(0,Ce.r)(t.value)||0n;return{token:{address:c.DG,name:r.nativeCurrency.name,symbol:r.nativeCurrency.symbol,icon:r.icon?.url},decimals:18,walletBalance:a,gasCostWei:i,transactionValueWei:d}},enabled:!!t&&!!n&&!!o,refetchInterval:()=>{if(!t.erc20Value)return 3e4}})}({transaction:t.transaction,account:o,supportedDestinations:r}),y=(0,T.QP)(),f=(0,Z.z)(),j=(0,J.UH)(f);return p&&l?(0,s.jsxs)(R.mc,{p:"lg",children:[(0,s.jsx)(R.rQ,{title:m?.name||"Transaction"}),(0,s.jsx)(D.h,{y:"lg"}),(0,s.jsxs)(R.mc,{children:[m?.image?(0,s.jsx)(ee.E,{client:n,src:m?.image,style:{width:"100%",borderRadius:h.YK.md,backgroundColor:y.colors.tertiaryBg}}):f?(0,s.jsxs)(R.mc,{flex:"row",center:"both",style:{padding:h.YK.md,marginBottom:h.YK.md,borderRadius:h.YK.md,backgroundColor:y.colors.tertiaryBg},children:[(0,s.jsx)(ne.j,{size:h.RK.xl,id:f.id,client:n}),(0,s.jsx)("div",{style:{flexGrow:1,borderBottom:"6px dotted",borderColor:y.colors.secondaryIconColor,marginLeft:h.YK.md,marginRight:h.YK.md}}),(0,s.jsx)(X.P,{client:n,size:h.RK.xl,chainIconUrl:l.icon?.url})]}):null,(0,s.jsx)(D.h,{y:"md"}),(0,s.jsxs)(R.mc,{flex:"row",children:[(0,s.jsx)(R.mc,{flex:"column",expand:!0,children:(0,s.jsx)(K.E,{size:"md",color:"primaryText",weight:700,children:"Price"})}),(0,s.jsx)(R.mc,{expand:!0,children:(0,s.jsxs)(R.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,s.jsx)(te.x,{chain:t.transaction.chain,client:e.client,size:"sm",token:p.token}),(0,s.jsxs)(K.E,{color:"primaryText",size:"md",weight:700,children:[String((0,u.Z)(Number((0,V.ow)(p.transactionValueWei,p.decimals)),6)),p.token.symbol]})]})})]}),(0,s.jsx)(D.h,{y:"md"}),(0,s.jsx)(R.N1,{}),(0,s.jsx)(D.h,{y:"md"}),(0,s.jsxs)(R.mc,{flex:"row",children:[(0,s.jsx)(R.mc,{flex:"column",expand:!0,children:(0,s.jsx)(K.E,{size:"xs",color:"secondaryText",children:"Gas Fees"})}),(0,s.jsx)(R.mc,{expand:!0,children:(0,s.jsx)(R.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:(0,s.jsx)(K.E,{color:j?"success":"primaryText",size:"xs",children:j?"Sponsored":`${String((0,u.Z)(Number((0,V.ow)(p.gasCostWei,l.nativeCurrency.decimals)),6))} ${l.nativeCurrency.symbol}`})})})]}),(0,s.jsx)(D.h,{y:"sm"}),(0,s.jsxs)(R.mc,{flex:"row",children:[(0,s.jsx)(R.mc,{flex:"column",expand:!0,children:(0,s.jsx)(K.E,{size:"xs",color:"secondaryText",children:"Network"})}),(0,s.jsx)(R.mc,{expand:!0,children:(0,s.jsxs)(R.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,s.jsx)(X.P,{chainIconUrl:l.icon?.url,size:"xs",client:e.client}),(0,s.jsx)(K.E,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:l.name})]})})]})]}),(0,s.jsx)(D.h,{y:"xl"}),o?(0,s.jsx)(W.$n,{variant:"accent",fullWidth:!0,onClick:()=>{let e=p.transactionValueWei;p.token.address!==c.DG||j||(e+=p.gasCostWei),(0,a.G)({event:"choose_payment_method_transaction_mode",client:n,walletAddress:o.address,walletType:f?.id}),d((0,V.ow)(e,p.decimals),t.transaction.chain,p.token)},children:"Choose Payment Method"}):(0,s.jsx)("div",{children:(0,s.jsx)(M.p,{...e.connectOptions,client:n,theme:y,connectButton:{style:{width:"100%"}}})})]}):(0,s.jsx)(b.x,{})}var Re=n(12087);function We(e){const t=(0,T.QP)();return(0,s.jsx)(R.mc,{bg:"tertiaryBg",style:{borderRadius:h.r8.lg,border:`1px solid ${t.colors.borderColor}`,...e.containerStyle},children:(0,s.jsxs)(W.$n,{fullWidth:!0,disabled:e.disabled,onClick:e.onClick,variant:"ghost",style:{justifyContent:"space-between",padding:h.YK.sm,backgroundColor:t.colors.tertiaryBg},gap:"sm",children:[(0,s.jsx)(ze,{client:e.client,address:e.address}),!e.disableChevron&&(0,s.jsx)(o.D3D,{width:h.RK.sm,height:h.RK.sm,style:{color:t.colors.secondaryText}}),e.checked&&(0,s.jsx)(o.Srz,{width:h.RK.md,height:h.RK.md})]})})}function ze(e){const{client:t,address:n}=e,o=(0,Re.F)().find((t=>t.getAccount()?.address===e.address)),r=e.walletId||o?.id,i=(0,J.vq)({client:t,address:n}),a=i.data||(0,d.Wr)(n),c=(0,J.$$)({client:t,ensName:i.data});return(0,s.jsxs)(R.mc,{flex:"row",center:"y",gap:"sm",color:"secondaryText",children:[c.data?(0,s.jsx)(ee.E,{src:c.data,width:h.RK.md,height:h.RK.md,style:{borderRadius:h.r8.sm},client:e.client}):r?(0,s.jsx)(ne.j,{id:r,size:h.RK.md,client:e.client}):null,(0,s.jsx)(K.E,{size:"sm",color:"primaryText",children:a||(0,d.Wr)(e.address)})]})}var Oe=n(69975);function Ie(e){return(0,s.jsxs)(R.mc,{children:[(0,s.jsx)(R.mc,{p:"lg",children:(0,s.jsx)(R.rQ,{title:"Pay with",onBack:e.onBack})}),(0,s.jsx)(R.N1,{}),(0,s.jsx)(D.h,{y:"lg"}),(0,s.jsx)(R.mc,{flex:"column",gap:"xs",px:"lg",children:Oe.qx.map((t=>(0,s.jsxs)(Be,{fullWidth:!0,variant:"secondary",onClick:()=>e.onSelect(t),gap:"sm",children:[(0,s.jsx)(t.icon,{size:h.RK.lg}),(0,s.jsxs)(R.mc,{flex:"column",gap:"xxs",children:[(0,s.jsx)(K.E,{color:"primaryText",children:t.shorthand}),(0,s.jsx)(K.E,{size:"sm",children:t.name})]})]},t.shorthand)))}),(0,s.jsx)(D.h,{y:"lg"})]})}const Be=(0,de.A)(W.$n)((()=>{const e=(0,T.QP)();return{background:e.colors.tertiaryBg,justifyContent:"flex-start",gap:h.YK.sm,padding:h.YK.sm,"&:hover":{background:e.colors.secondaryButtonBg,transform:"scale(1.01)"},transition:"background 200ms ease, transform 150ms ease"}}));var Fe=n(95669);function De(e,t){const n=(window.innerHeight-750)/2,s=(window.innerWidth-500)/2;return window.open(`${e}&theme=${t}`,"thirdweb Pay",`width=500, height=750, top=${n}, left=${s}`)}var Pe=n(63752),Le=n(73650),Ke=n(14956),Ne=n(84735),Me=n(50503),qe=n(41880),_e=n(40497);function $e(e){const t=(0,r.jE)(),{openedWindow:n,onSuccess:o}=e,a=(0,Ke.a)({intentId:e.intentId,client:e.client});let c="loading";"ON_RAMP_TRANSFER_FAILED"===a.data?.status||"PAYMENT_FAILED"===a.data?.status?c="failed":"CRYPTO_SWAP_FALLBACK"===a.data?.status?c="partialSuccess":"ON_RAMP_TRANSFER_COMPLETED"===a.data?.status&&(c="completed");const d=(0,i.useRef)(!1);(0,i.useEffect)((()=>{!d.current&&o&&"ON_RAMP_TRANSFER_COMPLETED"===a.data?.status&&(d.current=!0,o(a.data))}),[o,a.data]),(0,i.useEffect)((()=>{n&&a.data&&("CRYPTO_SWAP_REQUIRED"!==a.data?.status&&"ON_RAMP_TRANSFER_COMPLETED"!==a.data?.status||n.close())}),[a.data,n]);const l=(0,i.useRef)(!1);return(0,i.useEffect)((()=>{l.current||"ON_RAMP_TRANSFER_COMPLETED"!==a.data?.status||(l.current=!0,(0,w.V)(t))}),[a.data,t]),(0,i.useEffect)((()=>{"CRYPTO_SWAP_REQUIRED"===a.data?.status&&e.onShowSwapFlow(a.data)}),[a.data,e.onShowSwapFlow]),(0,s.jsxs)(R.mc,{p:"lg",children:[(0,s.jsx)(R.rQ,{title:e.title,onBack:e.onBack}),e.hasTwoSteps&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.h,{y:"lg"}),(0,s.jsx)(Ne.g,{steps:2,currentStep:1}),(0,s.jsx)(D.h,{y:"sm"}),(0,s.jsxs)(K.E,{size:"xs",children:["Step 1 of 2 - Buying ",e.quote.onRampToken.token.symbol," with",e.quote.fromCurrencyWithFees.currencySymbol]})]}),(0,s.jsx)(He,{uiStatus:c,onDone:e.onDone,fiatStatus:a.data,client:e.client,transactionMode:e.transactionMode,quote:e.quote,isEmbed:e.isEmbed})]})}function He(e){const{uiStatus:t}=e,n=e.fiatStatus?(0,qe.A)(e.fiatStatus):void 0,r=e.fiatStatus&&"NOT_FOUND"!==e.fiatStatus.status?e.fiatStatus:void 0,i=e.quote.onRampToken,a=(0,s.jsx)(_e.i,{client:e.client,token:r?.source?{chainId:r.source.token.chainId,address:r.source.token.tokenAddress,symbol:r.source.token.symbol||"",amount:r.source.amount}:{chainId:i.token.chainId,address:i.token.tokenAddress,symbol:i.token.symbol,amount:i.amount},fiat:{amount:e.quote.fromCurrencyWithFees.amount,currencySymbol:e.quote.fromCurrencyWithFees.currencySymbol},statusMeta:r?.source&&n?{color:n?.color,text:n?.status,txHash:r.source.transactionHash}:void 0});return(0,s.jsxs)(R.mc,{children:[(0,s.jsx)(D.h,{y:"xl"}),"loading"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.h,{y:"md"}),(0,s.jsx)(R.mc,{flex:"row",center:"x",children:(0,s.jsx)(P.y,{size:"xxl",color:"accentText"})}),(0,s.jsx)(D.h,{y:"md"}),(0,s.jsx)(K.E,{color:"primaryText",size:"lg",center:!0,children:"Buy Pending"}),(0,s.jsx)(D.h,{y:"sm"}),!(0,Le.Fr)()&&(0,s.jsx)(K.E,{center:!0,children:"Complete the purchase in popup"}),(0,s.jsx)(D.h,{y:"xxl"}),a]}),"failed"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.h,{y:"md"}),(0,s.jsx)(R.mc,{flex:"row",center:"x",children:(0,s.jsx)(Me.g,{size:h.RK["3xl"]})}),(0,s.jsx)(D.h,{y:"lg"}),(0,s.jsx)(K.E,{color:"primaryText",size:"lg",center:!0,children:"Transaction Failed"}),(0,s.jsx)(D.h,{y:"xxl"}),a]}),"completed"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.h,{y:"md"}),(0,s.jsx)(R.mc,{flex:"row",center:"x",color:"success",children:(0,s.jsx)(o.KaV,{width:h.RK["3xl"],height:h.RK["3xl"]})}),(0,s.jsx)(D.h,{y:"md"}),(0,s.jsx)(K.E,{color:"primaryText",size:"lg",center:!0,children:"Buy Complete"}),e.fiatStatus&&"NOT_FOUND"!==e.fiatStatus.status&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.h,{y:"xxl"}),a,(0,s.jsx)(D.h,{y:"sm"})]}),!e.isEmbed&&(0,s.jsx)(W.$n,{variant:"accent",fullWidth:!0,onClick:e.onDone,children:e.transactionMode?"Continue Transaction":"Done"})]})]})}var Ue=n(76792),Ye=n(49927);function Ge(e){const t=l(e.quote),[n,o]=(0,i.useState)(t?{id:"step-1"}:{id:"onramp-status"}),[r,c]=(0,i.useState)(e.openedWindow),d=(0,i.useCallback)((()=>{(0,Fe.H)({intentId:e.quote.intentId,client:e.client}).then((t=>{e.onSuccess(t)}))}),[e.onSuccess,e.quote.intentId,e.client]);return"step-1"===n.id?(0,s.jsx)(Ue.Y,{title:e.title,client:e.client,onBack:e.onBack,partialQuote:(0,Ue.z)(e.quote),step:1,onContinue:()=>{const t=De(e.quote.onRampLink,e.theme);(0,a.G)({event:"open_onramp_popup",client:e.client,walletAddress:e.payer.account.address,walletType:e.payer.wallet.id}),(0,Pe.b)({type:"fiat",intentId:e.quote.intentId}),c(t),o({id:"onramp-status"})}}):"onramp-status"===n.id?(0,s.jsx)($e,{title:e.title,client:e.client,intentId:e.quote.intentId,onBack:e.onBack,hasTwoSteps:t,openedWindow:r,quote:e.quote,onDone:e.onDone,onShowSwapFlow:e=>{o({id:"postonramp-swap",data:e})},transactionMode:e.transactionMode,isEmbed:e.isEmbed,onSuccess:e.onSuccess}):"postonramp-swap"===n.id?(0,s.jsx)(Ye.n,{title:e.title,status:n.data,quote:(0,Ue.z)(e.quote),client:e.client,onBack:e.onBack,onDone:e.onDone,onSwapFlowStarted:()=>{},transactionMode:e.transactionMode,isEmbed:e.isEmbed,payer:e.payer,onSuccess:d}):null}const Ve=(0,he.xH)({id:137,name:"Polygon",nativeCurrency:{name:"POL",symbol:"POL",decimals:18},blockExplorers:[{name:"PolygonScan",url:"https://polygonscan.com",apiUrl:"https://api.polygonscan.com/api"}]});var Qe=n(96130),Ze=n(49193);function Je(e){const{payOptions:t}=e,n=(!1!==t.buyWithFiat?t.buyWithFiat?.prefillSource?.currency:void 0)||function(){try{const e=Intl.DateTimeFormat().resolvedOptions().timeZone.toLowerCase();return e.includes("london")?"GBP":e.includes("europe")?"EUR":e.includes("japan")?"JPY":e.includes("canada")?"CAD":"USD"}catch{return"USD"}}(),[s,o]=(0,i.useState)(Oe.qx.find((e=>e.shorthand===n))||Oe.a2);return{selectedCurrency:s,setSelectedCurrency:o}}var Xe=n(72033);function et(e){const{name:t}=(0,Q.Kj)(e.chain);return(0,s.jsxs)(R.mc,{children:[(0,s.jsx)("div",{onClick:e=>{e.currentTarget.querySelector("input")?.focus()},children:(0,s.jsxs)(R.mc,{flex:"row",center:"both",gap:"xs",style:{flexWrap:"nowrap"},children:[(0,s.jsx)(Xe.pd,{variant:"outline",pattern:"^[0-9]*[.,]?[0-9]*$",inputMode:"decimal",tabIndex:-1,placeholder:"0",type:"text","data-placeholder":""===e.value,value:e.value||"0",disabled:e.freezeAmount,onClick:t=>{""===e.value&&t.currentTarget.setSelectionRange(t.currentTarget.value.length,t.currentTarget.value.length)},onChange:t=>{let n=t.target.value;n.startsWith(".")&&(n=`0${n}`);const s=Number(n);Number.isNaN(s)||(n.startsWith("0")&&!n.startsWith("0.")?e.onChange(n.slice(1)):e.onChange(n))},style:{border:"none",fontSize:(n=e.value,n.length>10?"26px":n.length>6?"34px":"50px"),boxShadow:"none",borderRadius:"0",padding:"0",paddingBlock:"2px",fontWeight:600,textAlign:"right",width:(()=>{let t=e.value.replace(".","").length;return e.value.includes(".")&&(t+=.3),`calc(${Math.max(1,t)}ch + 6px)`})(),maxWidth:"calc(100% - 100px)"}}),(0,s.jsx)(N.C,{token:e.token,chain:e.chain,size:"lg",color:"secondaryText"})]})}),!e.hideTokenSelector&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.h,{y:"sm"}),(0,s.jsx)(R.mc,{flex:"row",center:"x",children:(0,s.jsxs)(tt,{variant:"secondary",fullWidth:!0,style:{fontSize:h.J.sm},gap:"xxs",onClick:e.onSelectToken,disabled:e.freezeChainAndToken,children:[(0,s.jsxs)(R.mc,{flex:"row",center:"y",gap:"sm",children:[(0,s.jsx)(te.x,{token:e.token,chain:e.chain,size:"md",client:e.client}),(0,s.jsxs)(R.mc,{flex:"column",style:{gap:"4px"},children:[(0,s.jsx)(N.C,{token:e.token,chain:e.chain,size:"sm"}),t?(0,s.jsx)(K.E,{size:"xs",color:"secondaryText",children:t}):(0,s.jsx)(oe.E,{width:"90px",height:h.J.xs})]})]}),(0,s.jsx)(o.D3D,{width:h.RK.sm,height:h.RK.sm,style:{marginLeft:"auto"}})]})})]})]});var n}const tt=(0,de.A)(W.$n)((()=>{const e=(0,T.QP)();return{background:e.colors.tertiaryBg,border:`1px solid ${e.colors.borderColor}`,justifyContent:"flex-start",transition:"background 0.3s",padding:h.YK.sm}}));function nt(e){return(0,s.jsx)(R.mc,{flex:"column",gap:"xs",style:{alignItems:"flex-start"},children:e.quote.processingFees.map((e=>{const t=(0,u.Z)(Number(e.amount),6);return(0,s.jsxs)(R.mc,{flex:"row",gap:"xxs",children:[(0,s.jsxs)(K.E,{color:"primaryText",size:"sm",children:[0===t?"~":"",t," ",e.token.symbol]}),(0,s.jsxs)(K.E,{color:"secondaryText",size:"sm",children:["($",(e.amountUSDCents/100).toFixed(2),")"]})]},`${e.token.chainId}_${e.token.tokenAddress}_${t}`)}))})}function st(e){return(0,s.jsxs)(R.mc,{flex:"column",gap:"xs",children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,s.jsx)(K.E,{inline:!0,color:"secondaryText",children:"Amount"}),(0,s.jsxs)(K.E,{color:"primaryText",inline:!0,children:[(0,u.Z)(Number(e.quote.fromCurrency.amount),2),e.quote.fromCurrency.currencySymbol]})]}),e.quote.processingFees.map(((e,t)=>{const n=(0,u.Z)(Number(e.amount),6);return(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,s.jsx)(K.E,{inline:!0,color:"secondaryText",children:"NETWORK"===e.feeType?"Network Fee":"Processing Fee"}),(0,s.jsxs)(K.E,{color:"primaryText",inline:!0,children:[0===n?"~":"",n," ",e.currencySymbol]})]},t)})),(0,s.jsx)(D.h,{y:"xxs"}),(0,s.jsx)(R.N1,{}),(0,s.jsx)(D.h,{y:"xxs"}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,s.jsx)(K.E,{inline:!0,color:"secondaryText",children:"Total"}),(0,s.jsxs)(K.E,{color:"primaryText",inline:!0,children:[(0,u.Z)(Number(e.quote.fromCurrencyWithFees.amount),6),e.quote.fromCurrencyWithFees.currencySymbol]})]})]})}const ot=e=>(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 18 18",width:e.size,height:e.size,role:"presentation",children:(0,s.jsx)("path",{fill:"currentColor",d:"M15.6 4.6H1.85v-.55l12.1-.968v.968h1.65V2.4c0-1.21-.98-2.059-2.177-1.888L2.378 2.089C1.18 2.26.2 3.39.2 4.6v11a2.2 2.2 0 002.2 2.2h13.2a2.2 2.2 0 002.2-2.2V6.8a2.2 2.2 0 00-2.2-2.2zm-1.65 7.707a1.65 1.65 0 01-.63-3.176 1.65 1.65 0 11.63 3.176z"})});var rt=n(27621);function it(e){const{name:t}=(0,Q.Kj)(e.chain),n=(0,m.X)({address:e.payerAccount.address,chain:e.chain,tokenAddress:(0,U.r)(e.token)?void 0:e.token.address,client:e.client});return(0,s.jsxs)(R.mc,{bg:"tertiaryBg",borderColor:"borderColor",flex:"row",style:{borderWidth:"1px",borderTopWidth:0,borderStyle:"solid",flexWrap:"nowrap",justifyContent:"space-between",minHeight:"64px",alignItems:"center",...e.swapRequired?{borderBottom:"none"}:{borderBottomLeftRadius:h.r8.md,borderBottomRightRadius:h.r8.md}},children:[(0,s.jsxs)(W.$n,{variant:"ghost",onClick:e.onSelectToken,gap:"sm",style:{paddingInline:h.YK.sm,paddingBlock:h.YK.sm,minWidth:"50%",justifyContent:"flex-start"},disabled:e.freezeChainAndTokenSelection,children:[(0,s.jsx)(ce.f,{token:e.token,chain:e.chain,size:"md",client:e.client}),(0,s.jsxs)(R.mc,{flex:"column",gap:"3xs",children:[(0,s.jsxs)(R.mc,{flex:"row",gap:"xs",center:"y",color:"primaryText",children:[(0,s.jsx)(N.C,{token:e.token,chain:e.chain,size:"sm"}),(0,s.jsx)(o.D3D,{width:h.RK.sm,height:h.RK.sm})]}),t?(0,s.jsx)(K.E,{size:"xs",children:t}):(0,s.jsx)(oe.E,{width:"90px",height:h.J.xs})]})]}),(0,s.jsxs)("div",{style:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:h.YK.xxs,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",justifyContent:"center",paddingRight:h.YK.sm},children:[e.isLoading?(0,s.jsx)(oe.E,{width:"120px",height:h.J.md,color:"borderColor"}):(0,s.jsx)(K.E,{size:"md",color:e.value?"primaryText":"secondaryText",style:{},children:(0,u.Z)(Number(e.value),6)||""}),(0,s.jsxs)(R.mc,{flex:"row",gap:"xxs",center:"y",color:"secondaryText",children:[(0,s.jsx)(ot,{size:h.J.xs}),n.data?(0,s.jsx)(K.E,{size:"xs",color:"secondaryText",weight:500,children:(0,rt.j)(n.data,!1)}):(0,s.jsx)(oe.E,{width:"70px",height:h.J.xs})]})]})]})}var at=n(73765),ct=n(78611),dt=n(14250),lt=n(7911);var ut=n(96223),ht=n(15626);async function mt(e){const t=await(0,ut.sendTransaction)(e);return(0,ht.L)(t)}var xt=n(21300),pt=n(34267),yt=n(59724),ft=n(67503);function jt(e){const{title:t,onBack:n,receiverAddress:r,client:a,payer:d,onDone:l,chain:u,token:m,tokenAmount:x,transactionMode:p,setTransactionHash:j}=e,[g,w]=(0,i.useState)("transfer"),[b,k]=(0,i.useState)({id:"idle"}),{symbol:C}=(0,Q.ps)(u);return(0,s.jsxs)(R.mc,{p:"lg",children:[(0,s.jsx)(R.rQ,{title:t,onBack:n}),(0,s.jsx)(D.h,{y:"xl"}),p&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Ne.g,{steps:2,currentStep:"transfer"===g?1:2}),(0,s.jsx)(D.h,{y:"sm"}),(0,s.jsx)(K.E,{size:"sm",children:"transfer"===g?"Step 1 of 2 - Transfer funds":"Step 2 of 2 - Finalize transaction"}),(0,s.jsx)(D.h,{y:"xl"})]}),(0,s.jsxs)(R.mc,{flex:"row",center:"y",style:{justifyContent:"space-between"},children:[(0,s.jsx)(K.E,{size:"sm",children:"From"}),(0,s.jsx)(ze,{address:d.account.address,client:a})]}),(0,s.jsx)(D.h,{y:"md"}),(0,s.jsx)(R.N1,{}),(0,s.jsx)(D.h,{y:"md"}),(0,s.jsxs)(R.mc,{flex:"row",center:"y",style:{justifyContent:"space-between"},children:[(0,s.jsx)(K.E,{size:"sm",children:"To"}),(0,s.jsx)(ze,{address:r,client:a})]}),(0,s.jsx)(D.h,{y:"md"}),(0,s.jsx)(R.N1,{}),(0,s.jsx)(D.h,{y:"md"}),(0,s.jsx)(yt.k,{chainId:u.id,client:a,label:"Amount",tokenAmount:x,tokenSymbol:(0,U.r)(m)?C||"":m.symbol,tokenAddress:(0,U.r)(m)?c.DG:m.address}),(0,s.jsx)(D.h,{y:"lg"}),p&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.h,{y:"sm"}),(0,s.jsxs)(R.mc,{gap:"sm",flex:"row",style:{justifyContent:"space-between"},center:"y",color:"accentText",children:[(0,s.jsx)(pt.p,{isDone:"execute"===g,isActive:"transfer"===g,label:"transfer"===g?"Transfer":"Done"}),(0,s.jsx)(ft.w,{}),(0,s.jsx)(pt.p,{isDone:!1,label:"Finalize",isActive:"execute"===g})]}),(0,s.jsx)(D.h,{y:"lg"})]}),"error"===b.id&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(R.mc,{flex:"row",gap:"xs",center:"both",color:"danger",children:(0,s.jsx)(K.E,{color:"danger",size:"sm",style:{textAlign:"center"},children:"transfer"===g?`${b.error||"Failed to Transfer"}`:"Failed to Execute"})}),(0,s.jsx)(D.h,{y:"md"})]}),!p&&"execute"===g&&"done"===b.id&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(R.mc,{flex:"row",gap:"xs",center:"both",color:"success",children:[(0,s.jsx)(o.KaV,{width:h.RK.sm,height:h.RK.sm}),(0,s.jsx)(K.E,{color:"success",size:"sm",children:"Payment completed"})]}),(0,s.jsx)(D.h,{y:"md"})]}),d.chain.id!==u.id?(0,s.jsx)(L.b,{fullWidth:!0,variant:"accent",switchChain:async()=>{await e.payer.wallet.switchChain(u)}}):(0,s.jsxs)(W.$n,{variant:"accent",fullWidth:!0,disabled:"pending"===b.id,onClick:async()=>{if("execute"!==g)try{if(k({id:"pending"}),p){const t=(0,U.r)(m)?(0,xt.prepareTransaction)({client:a,chain:u,to:r,value:(0,V.fq)(x)}):(0,dt.k)({contract:(0,Y.P)({address:m.address,chain:u,client:a}),to:r,amount:x});await mt({account:e.payer.account,transaction:t}),w("execute"),k({id:"idle"})}else{const t=await async function(e){try{const t=(0,y.KI)(e.client),n=await t((0,f.gy)(),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({fromAddress:e.fromAddress,toAddress:e.toAddress,chainId:e.chainId,tokenAddress:e.tokenAddress,amount:e.amount,purchaseData:e.purchaseData})});if(!n.ok){const e=await n.json();if(e&&"error"in e)throw e;throw new Error(`HTTP error! status: ${n.status}`)}const s=(await n.json()).result;return{transactionRequest:{chain:(0,he.Q4)(s.transactionRequest.chainId),client:e.client,data:s.transactionRequest.data,to:s.transactionRequest.to,value:BigInt(s.transactionRequest.value),gas:BigInt(s.transactionRequest.gasLimit)},approval:s.approval?(0,lt.S)({contract:(0,Y.P)({client:e.client,address:s.approval.tokenAddress,chain:(0,he.Q4)(s.approval.chainId)}),spender:s.approval.spenderAddress,amountWei:BigInt(s.approval.amountWei)}):void 0,fromAddress:s.fromAddress,toAddress:s.toAddress,paymentToken:s.paymentToken,processingFee:s.processingFee,estimatedGasCostUSDCents:s.estimatedGasCostUSDCents,client:e.client}}catch(t){throw console.error("Error getting buy with crypto transfer",t),t}}({client:a,fromAddress:d.account.address,toAddress:r,chainId:u.id,tokenAddress:(0,U.r)(m)?c.DG:m.address,amount:x,purchaseData:void 0});t.approval&&(w("approve"),await mt({account:e.payer.account,transaction:t.approval})),w("transfer");const n=t.transactionRequest,s=await(0,ut.sendTransaction)({account:e.payer.account,transaction:n});j(s.transactionHash),k({id:"idle"})}}catch(t){console.error(t),k({id:"error",error:"error"in t?t.error?.message:t?.message})}else l()},gap:"xs",children:["execute"===g&&("done"===b.id?"Done":"Continue"),"transfer"===g&&("pending"===b.id?"Confirming":"Confirm"),"approve"===g&&("pending"===b.id?"Approving":"Approve"),"pending"===b.id&&(0,s.jsx)(P.y,{size:"sm",color:"accentButtonText"})]})]})}function gt(e){const[t,n]=(0,i.useState)();return t?(0,s.jsx)(ct.S,{title:e.title,onBack:e.onBack,onTryAgain:e.onTryAgain,swapTxHash:t,client:e.client,onDone:e.onDone,transactionMode:!1,isEmbed:e.isEmbed,quote:void 0,onSuccess:e.onSuccess}):(0,s.jsx)(jt,{...e,setTransactionHash:n})}function wt(e){const t=(0,T.QP)(),n=(0,Re.F)(),r=!e.showAllWallets&&e.wallets?.every((e=>n.includes(e)));return(0,s.jsxs)(R.mc,{children:[(0,s.jsxs)(R.mc,{flex:"column",gap:"xs",children:[n.filter((t=>!e.hiddenWallets?.includes(t.id))).map((t=>{const n=t.getAccount()?.address;return(0,s.jsx)(We,{walletId:t.id,client:e.client,address:n||"",onClick:()=>{e.onSelect(t),e.onBack()},disableChevron:!0,checked:!1},t.id)})),!r&&(0,s.jsx)(W.$n,{variant:"secondary",fullWidth:!0,onClick:e.onConnect,gap:"xs",bg:"tertiaryBg",style:{borderRadius:h.r8.lg,border:`1px solid ${t.colors.borderColor}`,padding:h.YK.sm},children:(0,s.jsxs)(R.mc,{flex:"row",gap:"sm",center:"y",expand:!0,children:[(0,s.jsx)(o.c11,{width:h.RK.md,height:h.RK.md}),(0,s.jsx)(K.E,{size:"sm",color:"primaryText",children:"Add Another Wallet"})]})})]}),(0,s.jsx)(D.h,{y:"sm"})]})}var bt=n(99418);function kt(e){const t=e.payOptions.buyWithCrypto?e.payOptions.buyWithCrypto.testMode:void 0,n=(0,bt.X)(e.client,t);return n.data?(0,s.jsx)(Ct,{...e,supportedDestinations:n.data}):(0,s.jsx)(b.x,{})}function Ct(e){const{client:t,supportedDestinations:n,connectLocale:o,payOptions:a}=e,d=(0,g.L)(),{payer:l,setPayer:u}=function(){const e=(0,Z.z)(),t=(0,g.L)(),n=(0,Qe.w)(),[s,o]=(0,i.useState)();return(0,i.useEffect)((()=>{const e=s?.wallet;function t(){if(!e)return void o(void 0);const t=e.getAccount(),n=e.getChain();o(t&&n?{account:t,chain:n,wallet:e}:void 0)}if(e){const n=e.subscribe("chainChanged",t),s=e.subscribe("accountChanged",t);return()=>{n(),s()}}}),[s]),{payer:s||(t&&n&&e?{account:t,chain:n,wallet:e}:void 0),setPayer:o}}(),[h,m]=(0,i.useState)({id:"main"}),{tokenAmount:x,setTokenAmount:p,toChain:y,setToChain:f,deferredTokenAmount:j,toToken:b,setToToken:k}=function(e){const{payOptions:t,supportedDestinations:n}=e,s=t?.prefillBuy,o=(0,Qe.w)(),r=s?.amount||"",[a,c]=(0,i.useState)(r),d=(0,Ze.o)(a,300),[l,u]=(0,i.useState)(s?.chain||"transaction"===t.mode&&t.transaction?.chain||"direct_payment"===t.mode&&t.paymentInfo?.chain||n.find((e=>e.chain.id===o?.id))?.chain||n[0]?.chain||Ve),[h,m]=(0,i.useState)(s?.token||"direct_payment"===t.mode&&t.paymentInfo.token||U.g);return{toChain:l,setToChain:u,toToken:h,setToToken:m,tokenAmount:a,setTokenAmount:c,deferredTokenAmount:d}}({payOptions:a,supportedDestinations:n}),[C,T]=(0,i.useState)(!1),S=(0,i.useCallback)((()=>{m({id:"main"}),e.onDone()}),[e.onDone]),v=(0,bt.m)({client:e.client,destinationChainId:y.id,destinationTokenAddress:(0,U.r)(b)?c.DG:b.address}),A=(0,i.useMemo)((()=>Wt(n,a,e.supportedTokens)),[e.supportedTokens,n,a]),E=(0,i.useMemo)((()=>{if(!v.data)return;return Wt(v.data,a,e.supportedTokens)}),[e.supportedTokens,v.data,a]),{fromChain:W,setFromChain:z,fromToken:O,setFromToken:I}=function(e){const{payOptions:t,supportedSources:n}=e,s=n?.length?n[0]:void 0,[o,r]=(0,i.useState)(),a=!1!==t.buyWithCrypto&&t.buyWithCrypto?.prefillSource?.chain||"transaction"===t.mode&&t.transaction?.chain||"direct_payment"===t.mode&&t.paymentInfo?.chain,c=s?.chain?s.chain:void 0,d=o||a||c||Ve,[l,u]=(0,i.useState)(),h=!1!==t.buyWithCrypto&&t.buyWithCrypto?.prefillSource?.token||"direct_payment"===t.mode&&t.paymentInfo.token,m=U.g;return{fromChain:d,setFromChain:r,fromToken:l||h||m||U.g,setFromToken:u}}({payOptions:a,supportedSources:v.data||[]}),{selectedCurrency:B,setSelectedCurrency:F}=Je({payOptions:a}),D=function(e){const{payOptions:t,supportedDestinations:n,toChain:s,toToken:o}=e,{fiat:r,swap:i}=function(){const e=n.find((e=>e.chain.id===s.id));if(!e)return{fiat:!1,swap:!1};const t=(0,U.r)(o)?c.DG:o.address,r=e.tokens.find((e=>e.address.toLowerCase()===t.toLowerCase()));return r?{fiat:r.buyWithFiatEnabled,swap:r.buyWithCryptoEnabled}:{fiat:!0,swap:!0}}(),a=!1!==t.buyWithFiat&&r,d=!1!==t.buyWithCrypto&&i;return{buyWithFiatEnabled:a,buyWithCryptoEnabled:d,showPaymentSelection:a&&d}}({payOptions:e.payOptions,supportedDestinations:e.supportedDestinations,toChain:y,toToken:b}),P=!1===D.showPaymentSelection&&!1===D.buyWithCryptoEnabled&&!1===D.buyWithFiatEnabled,L=(0,r.jE)(),K=(0,i.useCallback)((t=>{e.payOptions.onPurchaseSuccess?.({type:"crypto",status:t}),(0,w.V)(L)}),[e.payOptions.onPurchaseSuccess,L]),N=(0,i.useCallback)((t=>{e.payOptions.onPurchaseSuccess?.({type:"fiat",status:t}),(0,w.V)(L)}),[e.payOptions.onPurchaseSuccess,L]);if("connect-payer-wallet"===h.id)return(0,s.jsx)(H.r,{accountAbstraction:e.connectOptions?.accountAbstraction,appMetadata:e.connectOptions?.appMetadata,chain:e.connectOptions?.chain,chains:e.connectOptions?.chains,client:e.client,connectLocale:e.connectLocale,isEmbed:e.isEmbed,onBack:()=>m(h.backScreen),onSelect:e=>{const t=e.getAccount(),n=e.getChain();e&&t&&n&&u({account:t,chain:n,wallet:e})},hiddenWallets:e.hiddenWallets,recommendedWallets:e.connectOptions?.recommendedWallets,showAllWallets:void 0===e.connectOptions?.showAllWallets||e.connectOptions?.showAllWallets,walletConnect:e.connectOptions?.walletConnect,wallets:e.connectOptions?.wallets?.filter((e=>"inApp"!==e.id))});if("swap-flow"===h.id&&l)return(0,s.jsx)(at.K,{title:e.title,transactionMode:"transaction"===a.mode,isEmbed:e.isEmbed,client:t,onBack:()=>{m({id:"buy-with-crypto"})},buyWithCryptoQuote:h.quote,payer:l,isFiatFlow:!1,onDone:S,onTryAgain:()=>{m({id:"buy-with-crypto"})},onSuccess:K});if("fiat-flow"===h.id&&l)return(0,s.jsx)(Ge,{title:e.title,transactionMode:"transaction"===a.mode,quote:h.quote,onBack:()=>{m({id:"buy-with-fiat"})},client:t,testMode:!1!==e.payOptions.buyWithFiat&&!0===e.payOptions.buyWithFiat?.testMode,theme:"string"===typeof e.theme?e.theme:e.theme.type,openedWindow:h.openedWindow,onDone:S,isEmbed:e.isEmbed,payer:l,onSuccess:N});if("transfer-flow"===h.id&&l&&d){const t=()=>m({id:"buy-with-crypto"}),n=e.payOptions?.paymentInfo?.sellerAddress,o=n||d.address;return(0,s.jsx)(gt,{title:e.title,onBack:t,payer:l,client:e.client,chain:y,token:b,tokenAmount:x,receiverAddress:o,transactionMode:"transaction"===e.payOptions.mode,isEmbed:e.isEmbed,onDone:S,onTryAgain:()=>{m({id:"buy-with-crypto"})},onSuccess:K})}if("select-currency"===h.id){const e=()=>m(h.backScreen);return(0,s.jsx)(Ie,{onSelect:t=>{e(),F(t)},onBack:e})}if("select-to-token"===h.id){const r=n.map((e=>e.chain)),i=()=>m(h.backScreen),d=a?.prefillBuy?.allowEdits;return!1===d?.token?(0,s.jsx)(zt,{chains:r,client:e.client,connectLocale:e.connectLocale,setChain:f,goBack:i}):(0,s.jsx)($.T,{onBack:i,tokenList:((y?.id?A[y.id]:void 0)||[]).filter((e=>e.address!==c.DG)),onTokenSelect:e=>{k(e),i()},chain:y,chainSelection:!1!==d?.chain?{chains:r,select:e=>{f(e)}}:void 0,connectLocale:o,client:t,modalTitle:e.title})}if("select-from-token"===h.id&&v.data&&E){const n=v.data.map((e=>e.chain)),r=()=>m(h.backScreen);return!1!==a.buyWithCrypto&&!1===a.buyWithCrypto?.prefillSource?.allowEdits?.token?(0,s.jsx)(zt,{chains:n,client:e.client,connectLocale:e.connectLocale,setChain:z,goBack:r}):(0,s.jsx)($.T,{onBack:r,tokenList:((W?.id?E[W.id]:void 0)||[]).filter((e=>e.address!==c.DG)),onTokenSelect:e=>{I(e),r()},chain:W,chainSelection:!1!==a.buyWithCrypto&&!1!==a.buyWithCrypto?.prefillSource?.allowEdits?.chain?{chains:v.data.map((e=>e.chain)),select:e=>z(e)}:void 0,connectLocale:o,client:t,modalTitle:"Pay with"})}return(0,s.jsx)(R.mc,{animate:"fadein",children:(0,s.jsxs)("div",{children:["main"===h.id&&(0,s.jsx)(St,{title:e.title,payerAccount:l?.account,client:t,onSelectBuyToken:()=>m({id:"select-to-token",backScreen:h}),payOptions:a,setTokenAmount:p,setToChain:f,setToToken:k,setFromChain:z,setFromToken:I,toChain:y,toToken:b,tokenAmount:x,connectOptions:e.connectOptions,setScreen:m,supportedDestinations:n,onBack:e.onBack,theme:e.theme,hasEditedAmount:C,setHasEditedAmount:T,enabledPaymentMethods:D}),("select-payment-method"===h.id||"select-wallet"===h.id||"buy-with-crypto"===h.id||"buy-with-fiat"===h.id)&&l&&(0,s.jsxs)(vt,{title:e.title,selectedChain:y,selectedToken:b,tokenAmount:x,client:t,onBack:()=>{!D.showPaymentSelection||"select-wallet"!==h.id&&"buy-with-fiat"!==h.id?"buy-with-crypto"===h.id?m({id:"select-wallet"}):m({id:"main"}):m({id:"select-payment-method"})},children:["select-payment-method"===h.id&&(0,s.jsx)(At,{mode:a.mode,client:t,walletAddress:l.account.address,walletType:l.wallet.id,setScreen:e=>m({id:e})}),"select-wallet"===h.id&&(0,s.jsx)(wt,{client:t,hiddenWallets:e.hiddenWallets,onSelect:e=>{const t=e.getChain(),n=e.getAccount();t&&n&&(u({account:n,chain:t,wallet:e}),m({id:"buy-with-crypto"}))},showAllWallets:!!e.connectOptions?.showAllWallets,wallets:e.connectOptions?.wallets,onBack:()=>{},onConnect:()=>{m({id:"connect-payer-wallet",backScreen:{id:"select-wallet"}})},selectedAddress:l.account.address}),"buy-with-crypto"===h.id&&d&&(0,s.jsx)(Et,{setScreen:m,tokenAmount:j,toChain:y,toToken:b,fromChain:W,fromToken:O,showFromTokenSelector:()=>{m({id:"select-from-token",backScreen:h})},payer:l,client:t,isEmbed:e.isEmbed,onDone:S,payOptions:a,connectLocale:o,connectOptions:e.connectOptions,setPayer:u,activeAccount:d,setTokenAmount:p,setHasEditedAmount:T,disableTokenSelection:!0===P||!1!==a.buyWithCrypto&&!1===a.buyWithCrypto?.prefillSource?.allowEdits?.chain&&!1===a.buyWithCrypto?.prefillSource?.allowEdits?.token}),"buy-with-fiat"===h.id&&(0,s.jsx)(Rt,{setScreen:m,tokenAmount:j,toChain:y,toToken:b,selectedCurrency:B,client:t,isEmbed:e.isEmbed,onDone:S,payOptions:a,theme:e.theme,showCurrencySelector:()=>{m({id:"select-currency",backScreen:h})},payer:l,setTokenAmount:p,setHasEditedAmount:T})]})]})})}function Tt(e){return(0,s.jsx)("div",{children:(0,s.jsxs)(R.mc,{flex:"row",gap:"sm",center:"y",style:{justifyContent:"space-between"},children:[(0,s.jsxs)(R.mc,{flex:"row",gap:"xs",center:"y",children:[(0,s.jsx)(K.E,{color:"primaryText","data-testid":"tokenAmount",size:"xl",children:(0,u.Z)(Number(e.tokenAmount),6)}),(0,s.jsxs)(R.mc,{flex:"row",gap:"xxs",center:"y",children:[(0,s.jsx)(N.C,{token:e.selectedToken,chain:e.selectedChain,size:"md",color:"secondaryText"}),(0,s.jsx)(ce.f,{chain:e.selectedChain,client:e.client,size:"sm",token:e.selectedToken})]})]}),(0,s.jsx)(k.R,{chain:e.selectedChain,client:e.client,size:"sm",short:!0})]})})}function St(e){const{setTokenAmount:t,setToChain:n,setToToken:o,setFromChain:r,setFromToken:i,payerAccount:a,client:c,tokenAmount:d,payOptions:l,toToken:u,toChain:h,supportedDestinations:m,enabledPaymentMethods:x}=e,{showPaymentSelection:p,buyWithCryptoEnabled:y,buyWithFiatEnabled:f}=x,j=!d;switch(l.mode){case"transaction":return(0,s.jsx)(Ee,{supportedDestinations:m,payUiOptions:l,payerAccount:a,connectOptions:e.connectOptions,client:c,onContinue:(s,a,c)=>{t(s),n(a),r(a),i(c),o(c),p?e.setScreen({id:"select-payment-method"}):y?e.setScreen({id:"select-wallet"}):f?e.setScreen({id:"buy-with-fiat"}):e.setScreen({id:"select-wallet"})}});case"direct_payment":return(0,s.jsx)(se,{client:c,payUiOptions:l,payerAccount:a,connectOptions:e.connectOptions,supportedDestinations:m,onContinue:(s,a,c)=>{t(s),n(a),r(a),i(c),o(c),p?e.setScreen({id:"select-payment-method"}):y?e.setScreen({id:"buy-with-crypto"}):f?e.setScreen({id:"buy-with-fiat"}):e.setScreen({id:"select-wallet"})}});default:return(0,s.jsxs)(R.mc,{p:"lg",children:[(0,s.jsx)(R.rQ,{title:e.title,onBack:e.onBack}),(0,s.jsx)(D.h,{y:"xl"}),(0,s.jsx)(et,{value:d,onChange:async n=>{e.setHasEditedAmount(!0),t(n)},freezeAmount:!1===l.prefillBuy?.allowEdits?.amount,freezeChainAndToken:!1===l.prefillBuy?.allowEdits?.chain&&!1===l.prefillBuy?.allowEdits?.token,token:u,chain:h,onSelectToken:e.onSelectBuyToken,client:e.client}),(0,s.jsx)(D.h,{y:"xl"}),(0,s.jsx)(R.mc,{flex:"column",gap:"sm",children:a?(0,s.jsx)(W.$n,{variant:"accent",fullWidth:!0,disabled:j,"data-disabled":j,onClick:()=>{p?e.setScreen({id:"select-payment-method"}):y?e.setScreen({id:"buy-with-crypto"}):f?e.setScreen({id:"buy-with-fiat"}):console.error("No payment method enabled")},children:"Continue"}):(0,s.jsx)("div",{children:(0,s.jsx)(M.p,{...e.connectOptions,client:e.client,theme:e.theme,connectButton:{style:{width:"100%"}}})})})]})}}function vt(e){return(0,s.jsxs)(R.mc,{children:[(0,s.jsx)(R.mc,{p:"lg",children:(0,s.jsx)(R.rQ,{title:e.title,onBack:e.onBack})}),(0,s.jsxs)(R.mc,{px:"lg",style:{paddingBottom:h.YK.lg},children:[(0,s.jsx)(D.h,{y:"xs"}),(0,s.jsx)(Tt,{selectedToken:e.selectedToken,selectedChain:e.selectedChain,tokenAmount:e.tokenAmount,client:e.client}),(0,s.jsx)(D.h,{y:"md"}),(0,s.jsx)(R.N1,{}),(0,s.jsx)(D.h,{y:"lg"}),(0,s.jsx)(K.E,{size:"sm",children:" Pay with "}),(0,s.jsx)(D.h,{y:"sm"}),e.children]})]})}function At(e){return(0,s.jsx)(R.mc,{animate:"fadein",children:(0,s.jsxs)(R.mc,{flex:"column",gap:"sm",children:[(0,s.jsxs)(W.$n,{variant:"outline",bg:"tertiaryBg",onClick:()=>{(0,a.G)({event:`pay_with_credit_card_${e.mode||"unknown"}_mode`,client:e.client,walletAddress:e.walletAddress,walletType:e.walletType}),e.setScreen("buy-with-fiat")},gap:"sm",style:{justifyContent:"flex-start",textAlign:"left"},children:[(0,s.jsx)(R.mc,{color:"secondaryText",flex:"row",center:"both",children:(0,s.jsx)(o.HyM,{style:{width:h.RK.md,height:h.RK.md}})}),(0,s.jsxs)(R.mc,{flex:"column",gap:"xxs",children:[(0,s.jsx)(K.E,{size:"md",color:"primaryText",children:"Credit Card"}),(0,s.jsx)(K.E,{size:"xs",children:"Securely pay with credit card"})]})]}),(0,s.jsxs)(W.$n,{variant:"outline",bg:"tertiaryBg",onClick:()=>{(0,a.G)({event:`pay_with_crypto_${e.mode||"unknown"}_mode`,client:e.client,walletAddress:e.walletAddress,walletType:e.walletType}),e.setScreen("select-wallet")},style:{justifyContent:"flex-start"},gap:"sm",children:[(0,s.jsx)(R.mc,{color:"secondaryText",flex:"row",center:"both",children:(0,s.jsx)(_.g,{size:h.RK.md})}),(0,s.jsxs)(R.mc,{flex:"column",gap:"xxs",children:[(0,s.jsx)(K.E,{size:"md",color:"primaryText",children:"Crypto"}),(0,s.jsx)(K.E,{size:"xs",children:"Pay with your connected wallet"})]})]})]})})}function Et(e){const{setScreen:t,payer:n,client:o,toChain:r,tokenAmount:a,toToken:d,fromChain:l,fromToken:h,showFromTokenSelector:y,payOptions:f,disableTokenSelection:j}=e,g=e.payOptions?.paymentInfo?.sellerAddress,w=g||e.activeAccount.address,{drawerRef:b,drawerOverlayRef:k,isOpen:C,setIsOpen:T}=F(),[S,v]=(0,i.useState)("fees"),A=(0,m.X)({address:n.account.address,chain:l,tokenAddress:(0,U.r)(h)?void 0:h.address,client:o}),E=(0,U.r)(h)?c.DG:h.address.toLowerCase(),O=(0,U.r)(d)?c.DG:d.address.toLowerCase(),I=!!a&&!(l.id===r.id&&E===O),M=I?{fromAddress:n.account.address,toAddress:w,fromChainId:l.id,fromTokenAddress:(0,U.r)(h)?c.DG:h.address,toChainId:r.id,toTokenAddress:(0,U.r)(d)?c.DG:d.address,toAmount:a,client:o,purchaseData:f.purchaseData}:void 0,q=(_=M,$={staleTime:3e4,refetchInterval:3e4,gcTime:3e4},(0,x.I)({...$,queryKey:["buyWithCryptoQuote",_],queryFn:()=>{if(!_)throw new Error("Swap params are required");return(0,p.c)(_)},enabled:!!_,retry(e,t){if(e>3)return!1;try{const e=t.error;if("MINIMUM_PURCHASE_AMOUNT"===e.code)return!1;if(404===e.statusCode||e.statusCode>=500)return!1}catch{return!0}return!0}}));var _,$;const H=I?q.data?.swapDetails.fromAmount:a,Y=!!H&&!!A.data&&Number(A.data.displayValue)<Number(H),G=I&&!q.data||Y,V=e.payer.chain.id!==l.id;const Q=!q.isLoading&&q.error?function(e){try{if("MINIMUM_PURCHASE_AMOUNT"===e.error.code){const t=e.error.data.minimumAmountEth;return{minAmount:(0,u.Z)(Number(t),6)}}}catch{}return{msg:["Unable to get price quote"]}}(q.error):void 0;return(0,s.jsxs)(R.mc,{flex:"column",gap:"md",animate:"fadein",children:[C&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(B,{ref:k}),(0,s.jsx)(z,{ref:b,close:()=>T(!1),children:"fees"===S&&q.data&&(0,s.jsxs)("div",{children:[(0,s.jsx)(K.E,{size:"lg",color:"primaryText",children:"Fees"}),(0,s.jsx)(D.h,{y:"lg"}),(0,s.jsx)(nt,{quote:q.data})]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(We,{client:e.client,onClick:()=>{t({id:"select-wallet"})},address:e.payer.account.address,walletId:e.payer.wallet.id,containerStyle:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}),(0,s.jsx)(it,{value:H||"",onSelectToken:y,chain:l,token:h,isLoading:q.isLoading&&!H,client:o,freezeChainAndTokenSelection:j,payerAccount:e.payer.account,swapRequired:I}),I&&(0,s.jsx)(ie,{quoteIsLoading:q.isLoading,estimatedSeconds:q.data?.swapDetails.estimated.durationSeconds,onViewFees:function(){q.data&&(T(!0),v("fees"))}}),(0,s.jsx)(D.h,{y:"md"})]}),Q&&(0,s.jsxs)("div",{children:[Q.minAmount&&(0,s.jsxs)(K.E,{color:"danger",size:"sm",center:!0,multiline:!0,children:["Minimum amount is ",Q.minAmount,(0,s.jsx)(N.C,{token:d,chain:r,size:"sm",inline:!0,color:"danger"})]}),Q.msg?.map((e=>(0,s.jsx)(K.E,{color:"danger",size:"sm",center:!0,multiline:!0,children:e},e)))]}),!Q&&Y&&(0,s.jsxs)("div",{children:[(0,s.jsx)(K.E,{color:"danger",size:"sm",center:!0,multiline:!0,children:"Not enough funds."}),(0,s.jsx)(K.E,{color:"danger",size:"sm",center:!0,multiline:!0,children:"Try a different wallet or token."})]}),Q?.minAmount?(0,s.jsx)(W.$n,{variant:"accent",fullWidth:!0,onClick:()=>{e.setTokenAmount(String(Q.minAmount)),e.setHasEditedAmount(!0)},children:"Set Minimum"}):!V||q.isLoading||Y||q.error?(0,s.jsx)(W.$n,{variant:G?"outline":"accent",fullWidth:!0,"data-disabled":G,disabled:G,onClick:async()=>{G||function(){if("direct_payment"!==e.payOptions.mode&&"fund_wallet"!==e.payOptions.mode||Y||I){if("transaction"===e.payOptions.mode&&!Y&&!I)return void(n.account.address!==w?t({id:"transfer-flow"}):e.onDone())}else t({id:"transfer-flow"});q.data&&t({id:"swap-flow",quote:q.data})}()},gap:"xs",children:q.isLoading?(0,s.jsxs)(s.Fragment,{children:["Getting price quote",(0,s.jsx)(P.y,{size:"sm",color:"accentText"})]}):"Continue"}):(0,s.jsx)(L.b,{variant:"accent",fullWidth:!0,switchChain:async()=>{await e.payer.wallet.switchChain(l)}})]})}function Rt(e){const{toToken:t,tokenAmount:n,payer:o,client:r,setScreen:a,toChain:d,showCurrencySelector:h,selectedCurrency:m}=e,x=e.payOptions?.paymentInfo?.sellerAddress,p=x||e.payer.account.address,{drawerRef:y,drawerOverlayRef:f,isOpen:g,setIsOpen:w}=F(),[b,k]=(0,i.useState)("fees"),C=e.payOptions.buyWithFiat,T=j(!1!==C&&n?{fromCurrencySymbol:m.shorthand,toChainId:d.id,toAddress:p,toTokenAddress:(0,U.r)(t)?c.DG:t.address,toAmount:n,client:r,isTestMode:C?.testMode,purchaseData:e.payOptions.purchaseData,fromAddress:o.account.address,preferredProvider:C?.preferredProvider}:void 0);const S=!T.data,v=!T.isLoading&&T.error?function(e){try{if("MINIMUM_PURCHASE_AMOUNT"===e.error.code){const t=e.error.data.minimumAmountEth;return{minAmount:(0,u.Z)(Number(t),6)}}}catch{}return{msg:["Unable to get price quote"]}}(T.error):void 0;return(0,s.jsxs)(R.mc,{flex:"column",gap:"md",animate:"fadein",children:[g&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(B,{ref:f}),(0,s.jsx)(z,{ref:y,close:()=>w(!1),children:"fees"===b&&T.data&&(0,s.jsxs)("div",{children:[(0,s.jsx)(K.E,{size:"lg",color:"primaryText",children:"Fees"}),(0,s.jsx)(D.h,{y:"lg"}),(0,s.jsx)(st,{quote:T.data})]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(le,{isLoading:T.isLoading,value:T.data?.fromCurrencyWithFees.amount,client:r,currency:m,onSelectCurrency:h}),(0,s.jsx)(ie,{quoteIsLoading:T.isLoading,estimatedSeconds:T.data?.estimatedDurationSeconds,onViewFees:function(){T.data&&(k("fees"),w(!0))}}),(0,s.jsx)(D.h,{y:"md"})]}),v&&(0,s.jsxs)("div",{children:[v.minAmount&&(0,s.jsxs)(K.E,{color:"danger",size:"sm",center:!0,multiline:!0,children:["Minimum amount is ",v.minAmount,(0,s.jsx)(N.C,{token:t,chain:d,size:"sm",inline:!0,color:"danger"})]}),v.msg?.map((e=>(0,s.jsx)(K.E,{color:"danger",size:"sm",center:!0,multiline:!0,children:e},e)))]}),v?.minAmount?(0,s.jsx)(W.$n,{variant:"accent",fullWidth:!0,onClick:()=>{e.setTokenAmount(String(v.minAmount)),e.setHasEditedAmount(!0)},children:"Set Minimum"}):(0,s.jsx)(W.$n,{variant:S?"outline":"accent","data-disabled":S,disabled:S,fullWidth:!0,onClick:function(){if(!T.data)return;let t=null;l(T.data)||(t=De(T.data.onRampLink,"string"===typeof e.theme?e.theme:e.theme.type),(0,Pe.b)({type:"fiat",intentId:T.data.intentId})),a({id:"fiat-flow",quote:T.data,openedWindow:t})},gap:"xs",children:T.isLoading?(0,s.jsxs)(s.Fragment,{children:["Getting price quote",(0,s.jsx)(P.y,{size:"sm",color:"accentText"})]}):"Continue"})]})}function Wt(e,t,n){const s={},o=!1===t.buyWithFiat,r=!1===t.buyWithCrypto;for(const i of e)s[i.chain.id]=i.tokens.filter((e=>!(!e.buyWithCryptoEnabled||!e.buyWithFiatEnabled)||!(!e.buyWithCryptoEnabled&&o)&&!(!e.buyWithFiatEnabled&&r)));if(n)for(const i in n){const e=Number(i),t=n[e];t&&(s[e]=t)}return s}function zt(e){return(0,s.jsx)(q.Hh,{client:e.client,connectLocale:e.connectLocale,showTabs:!1,onBack:e.goBack,chains:e.chains,closeModal:e.goBack,networkSelector:{renderChain:t=>(0,s.jsx)(q.O$,{chain:t.chain,confirming:!1,switchingFailed:!1,onClick:()=>{e.setChain(t.chain),e.goBack()},client:e.client,connectLocale:e.connectLocale})}})}}}]);
//# sourceMappingURL=39674.9184d27b.chunk.js.map