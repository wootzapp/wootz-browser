// Copyright 2024 The Chromium Authors

// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

module blink.mojom;

// ============ Definition for WebDXFeature used for UseCounter ===========
//
// Do not change assigned numbers of existing items: add new features
// to the end of the list.
//
// If you want to mark an item as no-longer-used, simply rename it, prefixing
// "kOBSOLETE_" before the existing name.
// E.g. kFrobulate becomes kOBSOLETE_Frobulate.
//
// A WebDXFeature counter represents actual usage of a high level feature (as
// defined in https://github.com/web-platform-dx/web-features). A WebDXFeature
// can be a JS API, an HTML element, CSS, etc. Generally, we want these counters
// to count usage of a feature by a web developer on a page. I.e. aim to count
// along the following principles:
//
//   * JS invocable API: Call on invocation of central entry points
//     (i.e. constructor, main API method implementations, or other central
//     code paths not likely to be triggered by feature detection or
//     fingerprinting on a web page), or triggered by internal usage in the
//     renderer.
//
//   * HTML: Count when an element is observed, either by being parsed or
//     constructed by script.
//
//   * CSS: Count when a feature is actually used by the page, not just present
//     in CSS.
//
// The names of features in this enum should map to the identifiers (i.e. .yml
// file names) used by the WebDX community group at the W3C
// (https://github.com/web-platform-dx/web-features/tree/main/features).
// Those identifiers are all lower case alphanumeric identifiers, with dashes
// (-) as word separators. To translate those identifier names to enum names
// here, start with a lower case 'k', then camelcase the name and remove the
// dashes. I.e. "view-transitions" becomes kViewTransitions. More discussion
// about WebDX feature identifier naming can be found at
// https://github.com/web-platform-dx/web-features/tree/main/docs#identifiers

enum WebDXFeature {
  kPageVisits = 0,
  kCompressionStreams = 1,
  kViewTransitions = 2,
  kPopover = 3,
  kSubgrid = 4,
  kCascadeLayers = 5,

  // Add new features immediately above this line. Don't change assigned
  // numbers of any item, and don't reuse removed slots.
  // Also, run update_use_counter_feature_enum.py in
  // chromium/src/tools/metrics/histograms/ to update the UMA mapping.
  // TODO(dcheng): Fix https://crbug.com/742517 and use the autogenerated
  // constants.
  kNumberOfFeatures,  // This enum value must be last.
};
