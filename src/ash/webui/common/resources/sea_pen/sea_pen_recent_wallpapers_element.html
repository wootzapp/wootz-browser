<style include="wallpaper common sea-pen">
  :host {
    display: block;
    overflow: hidden;
  }

  iron-list {
    width: 100%;
  }

  .recent-image-container {
    height: calc(var(--personalization-app-grid-item-height) + var(--personalization-app-grid-item-spacing));
    /* Media queries in trusted and untrusted code will resize to 25% at
     * correct widths.  Subtract 0.34px to fix subpixel rounding issues with
     * iron-list. This makes sure all photo containers on a row add up to at
     * least 1px smaller than the parent width.*/
    width: calc(100% / 3 - 0.34px);
  }

  @media(min-width: 720px) {
    .recent-image-container {
      /* Subtract 0.25px to fix subpixel rounding issues with iron-list. This
       * ensures all grid items in a row add up to at least 1px smaller than the
       * parent width. */
      width: calc(100% / 4 - 0.25px);
    }
  }

  .menu-icon-container {
    align-items: flex-end;
    bottom: 10px;
    display: flex;
    justify-content: flex-end;
    height: 28px;
    position: absolute;
    right: 10px;
    width: 28px;
    z-index: 1;
  }

  .menu-icon-container-inner {
    align-items: flex-end;
    background-color: var(--cros-bg-color);
    border-top-left-radius: 50%;
    bottom: 0;
    display: flex;
    height: 26px;
    justify-content: flex-end;
    position: absolute;
    right: 0;
    width: 26px;
  }

  div[class^="menu-icon-container-shadow"] {
    height: 12px;
    overflow: hidden;
    position: absolute;
    width: 12px;
  }

  div[class^="menu-icon-container-shadow"]::before {
    border-bottom-right-radius: 100%;
    bottom: 0;
    box-shadow: 0px 12px 0px 12px var(--cros-bg-color);
    content: '';
    height: 100%;
    position: absolute;
    right: 0;
    width: 100%;
  }

  .menu-icon-container-shadow-left {
    right: 26px;
  }

  .menu-icon-container-shadow-top {
    bottom: 26px;
  }

  .menu-icon-button {
    --cr-icon-button-size: 20px;
    background-color: var(--cros-bg-color);
    bottom: 1px;
    margin-inline: 0;
    position: absolute;
  }

  .dropdown-item > iron-icon {
    --iron-icon-fill-color: var(--cros-sys-on_surface);
    --iron-icon-height: 20px;
    --iron-icon-width: 20px;
    margin-inline-end: 16px;
  }

  .more-like-this-option {
    display: none;
  }
</style>
<template is="dom-if" if="[[shouldShowRecentlyUsedWallpapers_(recentImages_)]]">
  <h2 class="wallpaper-collections-heading">[[getRecentPoweredByGoogleMessage_()]]</h2>
  <iron-list id="grid"
      items="[[recentImagesToDisplay_]]"
      as="image"
      grid
      aria-setsize$="[[recentImagesToDisplay_.length]]"
      role="listbox">
    <template>
      <div class="recent-image-container">
        <wallpaper-grid-item
            class="sea-pen-image"
            index="[[index]]"
            data-sea-pen-image
            aria-posinset$="[[getAriaIndex_(index)]]"
            on-wallpaper-grid-item-selected="onRecentImageSelected_"
            role="option"
            selected="[[isRecentImageSelected_(image, currentSelected_, pendingSelected_)]]"
            src="[[getRecentImageUrl_(image, recentImageData_, recentImageDataLoading_)]]"
            tabindex$="[[tabIndex]]">
        </wallpaper-grid-item>
        <div class="menu-icon-container">
          <div class="menu-icon-container-inner">
            <cr-icon-button class="menu-icon-button" data-id$="[[index]]" iron-icon="cr:more-vert"
              role="button" on-click="onClickMenuIcon_" tabindex$="[[tabIndex]]">
            </cr-icon-button>
          </div>
          <div class="menu-icon-container-shadow-left"></div>
          <div class="menu-icon-container-shadow-top"></div>
        </div>
        <cr-action-menu class="action-menu-container">
          <button data-id$="[[index]]" class="dropdown-item more-like-this-option"
              on-click="onClickMoreLikeThis_">
            <iron-icon icon="cr:add"></iron-icon>
            [[i18n('seaPenCreateMore')]]
          </button>
          <button class="dropdown-item delete-wallpaper-option"
              on-click="onClickDeleteWallpaper_">
            <iron-icon icon="sea-pen:delete"></iron-icon>
            [[i18n('seaPenDeleteWallpaper')]]
          </button>
          <template is="dom-if" if="[[shouldShowWallpaperInfoButton_(image, recentImageData_, recentImageDataLoading_)]]">
            <button data-id$="[[index]]" class="dropdown-item wallpaper-info-option"
                on-click="onClickWallpaperInfo_">
              <iron-icon icon="cr:info-outline"></iron-icon>
              [[i18n('seaPenAbout')]]
            </button>
          </template>
        </cr-action-menu>
        <template is="dom-if" if="[[shouldShowWallpaperInfoDialog_(index, currentShowWallpaperInfoDialog_)]]" restamp>
          <cr-dialog id="wallpaperInfoDialog" data-id$="[[index]]" on-close="onCloseDialog_" show-on-attach>
            <div slot="body">
              <h2>[[i18n('seaPenAboutDialogTitle')]]</h2>
              <p class="about-prompt-info">
                [[getWallpaperInfoPromptMessage_(image, recentImageData_, recentImageDataLoading_)]]
              </p>
              <p class="about-date-info">
                [[getWallpaperInfoDateMessage_(image, recentImageData_, recentImageDataLoading_)]]
              </p>
            </div>
            <div slot="button-container">
              <cr-button id="wallpaperInfoCloseButton" class="action-button primary" on-click="onCloseDialog_">
                [[i18n('seaPenAboutDialogClose')]]
              </cr-button>
            </div>
          </cr-dialog>
        </template>
      </div>
    </template>
  </iron-list>
</template>
